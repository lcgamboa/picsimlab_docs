<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PICSimLab - Programmable IC Simulator Laboratory: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="picsimlab.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PICSimLab - Programmable IC Simulator Laboratory
   &#160;<span id="projectnumber">0.8.10</span>
   </div>
   <div id="projectbrief">PICSimLab - API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>This is the documentation to explain the use of picsimlab internal classes.</p>
<p>The main objective of this domentation is to enable the expansion of the simulator with the creation of new boards (<a class="el" href="classboard.html">board</a>) and parts (<a class="el" href="classpart.html">part</a>).</p>
<h1><a class="anchor" id="partex"></a>
Part example</h1>
<h2><a class="anchor" id="pinc"></a>
part_servo.h</h2>
<div class="fragment"><div class="line"><span class="comment">/* ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   PICsimLab - PIC laboratory simulator</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Copyright (c) : 2010-2020  Luis Claudio Gambôa Lopes</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">   the Free Software Foundation; either version 2, or (at your option)</span></div>
<div class="line"><span class="comment">   any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">   along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   For e-mail suggestions :  lcgamboa@yahoo.com</span></div>
<div class="line"><span class="comment">   ######################################################################## */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef PART_SERVO_H</span></div>
<div class="line"><span class="preprocessor">#define PART_SERVO_H</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include&lt;lxrad.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include&quot;part.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define PART_SERVO_Name &quot;Servo Motor&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code" href="classcpart__servo.html">cpart_servo</a>:<span class="keyword">public</span> <a class="code" href="classpart.html">part</a></div>
<div class="line">{</div>
<div class="line">   <span class="keyword">public</span>:</div>
<div class="line">      lxString <a class="code" href="classcpart__servo.html#a369e48b1d7406e0aa2364c0aef1c9e96">GetName</a>(<span class="keywordtype">void</span>)<span class="keyword"> override </span>{<span class="keywordflow">return</span> lxT(PART_SERVO_Name);};</div>
<div class="line">      lxString <a class="code" href="classcpart__servo.html#ac842a5c8444381ca1bf23468403ce549">GetAboutInfo</a>(<span class="keywordtype">void</span>)<span class="keyword"> override </span>{<span class="keywordflow">return</span> lxT(<span class="stringliteral">&quot;L.C. Gamboa \n &lt;lcgamboa@yahoo.com&gt;&quot;</span>);};      </div>
<div class="line">      </div>
<div class="line">      <a class="code" href="classcpart__servo.html#a38f5b70c1f63626da3951a5ce57bc16f">cpart_servo</a>(<span class="keywordtype">unsigned</span> x, <span class="keywordtype">unsigned</span> y);</div>
<div class="line">     </div>
<div class="line">      <a class="code" href="classcpart__servo.html#aec280c6ce5b18601e15231a2f3622e6a">~cpart_servo</a>(<span class="keywordtype">void</span>);</div>
<div class="line">      </div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#afb87939ab462851e162586d40991515c">Draw</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#a774812d1ea393ac0328de09efbe97490">Process</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#a5cd43fc2214c65bdfbac5291228f8376">PostProcess</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#a4a1e164fd0f4145fafe870f5f28f350a">ConfigurePropertiesWindow</a>(CPWindow *  WProp) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#a1eac73056884d0a33e66bb850e4827a3">ReadPropertiesWindow</a>(CPWindow * WProp) <span class="keyword">override</span>;</div>
<div class="line">      lxString <a class="code" href="classcpart__servo.html#a4a16d8728aa01dc94f0b544d6b8aace0">WritePreferences</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#a37bfdfaf3fadd46d34338be0a6ca34f7">ReadPreferences</a>(lxString value) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#ac20457f24fcbfea16c0b8bcbc78d4faf">SetOrientation</a>(<span class="keywordtype">int</span> orientation) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#af7c0accf52260ff6f9e150c5f9c632b1">SetScale</a>(<span class="keywordtype">double</span> scale) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classcpart__servo.html#a5fa49b34102d782755dd5f5ef172f13d">get_in_id</a>(<span class="keywordtype">char</span> * name) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classcpart__servo.html#a57b0dc4b8c939e2ea78065a03dda0bd3">get_out_id</a>(<span class="keywordtype">char</span> * name) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keyword">private</span>: </div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcpart__servo.html#a5092323ea79d9f6152f9e5eaf65f7ee7">RegisterRemoteControl</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;          </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a>; </div>
<div class="line">      lxBitmap * <a class="code" href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">BackGround</a>;   </div>
<div class="line">      <span class="keywordtype">float</span> <a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a>;             </div>
<div class="line">      <span class="keywordtype">float</span> <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a>;            </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[2];    </div>
<div class="line">      <span class="keywordtype">int</span> <a class="code" href="classcpart__servo.html#a143b73817ed78ff25408bd0eec5f4755">time</a>;                </div>
<div class="line">      lxFont font;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif  </span><span class="comment">/* PART_SERVO */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="ttc" id="aclasscpart__servo_html"><div class="ttname"><a href="classcpart__servo.html">cpart_servo</a></div><div class="ttdoc">servo motor part class</div><div class="ttdef"><b>Definition:</b> part_servo.h:40</div></div>
<div class="ttc" id="aclasscpart__servo_html_a0af2e1168aeb456ba1f6a0a1511c1019"><div class="ttname"><a href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">cpart_servo::angle</a></div><div class="ttdeci">float angle</div><div class="ttdoc">angle of shaft</div><div class="ttdef"><b>Definition:</b> part_servo.h:72</div></div>
<div class="ttc" id="aclasscpart__servo_html_a143b73817ed78ff25408bd0eec5f4755"><div class="ttname"><a href="classcpart__servo.html#a143b73817ed78ff25408bd0eec5f4755">cpart_servo::time</a></div><div class="ttdeci">int time</div><div class="ttdoc">pulse time</div><div class="ttdef"><b>Definition:</b> part_servo.h:75</div></div>
<div class="ttc" id="aclasscpart__servo_html_a1eac73056884d0a33e66bb850e4827a3"><div class="ttname"><a href="classcpart__servo.html#a1eac73056884d0a33e66bb850e4827a3">cpart_servo::ReadPropertiesWindow</a></div><div class="ttdeci">void ReadPropertiesWindow(CPWindow *WProp) override</div><div class="ttdoc">Called when properties window close.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:239</div></div>
<div class="ttc" id="aclasscpart__servo_html_a22893b0e5a587b655f947d0450964303"><div class="ttname"><a href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">cpart_servo::angle_</a></div><div class="ttdeci">float angle_</div><div class="ttdoc">old angle of shaft</div><div class="ttdef"><b>Definition:</b> part_servo.h:73</div></div>
<div class="ttc" id="aclasscpart__servo_html_a369e48b1d7406e0aa2364c0aef1c9e96"><div class="ttname"><a href="classcpart__servo.html#a369e48b1d7406e0aa2364c0aef1c9e96">cpart_servo::GetName</a></div><div class="ttdeci">lxString GetName(void) override</div><div class="ttdoc">Return the name of part.</div><div class="ttdef"><b>Definition:</b> part_servo.h:42</div></div>
<div class="ttc" id="aclasscpart__servo_html_a37bfdfaf3fadd46d34338be0a6ca34f7"><div class="ttname"><a href="classcpart__servo.html#a37bfdfaf3fadd46d34338be0a6ca34f7">cpart_servo::ReadPreferences</a></div><div class="ttdeci">void ReadPreferences(lxString value) override</div><div class="ttdoc">Called whe configuration file load preferences.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:204</div></div>
<div class="ttc" id="aclasscpart__servo_html_a38f5b70c1f63626da3951a5ce57bc16f"><div class="ttname"><a href="classcpart__servo.html#a38f5b70c1f63626da3951a5ce57bc16f">cpart_servo::cpart_servo</a></div><div class="ttdeci">cpart_servo(unsigned x, unsigned y)</div><div class="ttdoc">constructor called once on part creation</div><div class="ttdef"><b>Definition:</b> part_servo.cc:37</div></div>
<div class="ttc" id="aclasscpart__servo_html_a4a16d8728aa01dc94f0b544d6b8aace0"><div class="ttname"><a href="classcpart__servo.html#a4a16d8728aa01dc94f0b544d6b8aace0">cpart_servo::WritePreferences</a></div><div class="ttdeci">lxString WritePreferences(void) override</div><div class="ttdoc">Called to save part preferences in configuration file.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:194</div></div>
<div class="ttc" id="aclasscpart__servo_html_a4a1e164fd0f4145fafe870f5f28f350a"><div class="ttname"><a href="classcpart__servo.html#a4a1e164fd0f4145fafe870f5f28f350a">cpart_servo::ConfigurePropertiesWindow</a></div><div class="ttdeci">void ConfigurePropertiesWindow(CPWindow *WProp) override</div><div class="ttdoc">Called to configure the properties window.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:217</div></div>
<div class="ttc" id="aclasscpart__servo_html_a5092323ea79d9f6152f9e5eaf65f7ee7"><div class="ttname"><a href="classcpart__servo.html#a5092323ea79d9f6152f9e5eaf65f7ee7">cpart_servo::RegisterRemoteControl</a></div><div class="ttdeci">void RegisterRemoteControl(void) override</div><div class="ttdoc">Register remote control variables.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:211</div></div>
<div class="ttc" id="aclasscpart__servo_html_a57b0dc4b8c939e2ea78065a03dda0bd3"><div class="ttname"><a href="classcpart__servo.html#a57b0dc4b8c939e2ea78065a03dda0bd3">cpart_servo::get_out_id</a></div><div class="ttdeci">unsigned short get_out_id(char *name) override</div><div class="ttdoc">return the output ids numbers of names used in output map</div><div class="ttdef"><b>Definition:</b> part_servo.cc:183</div></div>
<div class="ttc" id="aclasscpart__servo_html_a5cd43fc2214c65bdfbac5291228f8376"><div class="ttname"><a href="classcpart__servo.html#a5cd43fc2214c65bdfbac5291228f8376">cpart_servo::PostProcess</a></div><div class="ttdeci">void PostProcess(void) override</div><div class="ttdoc">Called every end of CPU process.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:152</div></div>
<div class="ttc" id="aclasscpart__servo_html_a5fa49b34102d782755dd5f5ef172f13d"><div class="ttname"><a href="classcpart__servo.html#a5fa49b34102d782755dd5f5ef172f13d">cpart_servo::get_in_id</a></div><div class="ttdeci">unsigned short get_in_id(char *name) override</div><div class="ttdoc">return the input ids numbers of names used in input map</div><div class="ttdef"><b>Definition:</b> part_servo.cc:176</div></div>
<div class="ttc" id="aclasscpart__servo_html_a774812d1ea393ac0328de09efbe97490"><div class="ttname"><a href="classcpart__servo.html#a774812d1ea393ac0328de09efbe97490">cpart_servo::Process</a></div><div class="ttdeci">void Process(void) override</div><div class="ttdoc">Called every CPU step.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:124</div></div>
<div class="ttc" id="aclasscpart__servo_html_a840063c98f8a8635554d9f8a1e297181"><div class="ttname"><a href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">cpart_servo::in_</a></div><div class="ttdeci">unsigned char in_[2]</div><div class="ttdoc">input pin memory</div><div class="ttdef"><b>Definition:</b> part_servo.h:74</div></div>
<div class="ttc" id="aclasscpart__servo_html_a9b4c8f6557bae63ba5645c4aeb31a519"><div class="ttname"><a href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">cpart_servo::BackGround</a></div><div class="ttdeci">lxBitmap * BackGround</div><div class="ttdoc">Background image.</div><div class="ttdef"><b>Definition:</b> part_servo.h:71</div></div>
<div class="ttc" id="aclasscpart__servo_html_ac20457f24fcbfea16c0b8bcbc78d4faf"><div class="ttname"><a href="classcpart__servo.html#ac20457f24fcbfea16c0b8bcbc78d4faf">cpart_servo::SetOrientation</a></div><div class="ttdeci">void SetOrientation(int orientation) override</div><div class="ttdoc">Set the orientation to draw.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:246</div></div>
<div class="ttc" id="aclasscpart__servo_html_ac842a5c8444381ca1bf23468403ce549"><div class="ttname"><a href="classcpart__servo.html#ac842a5c8444381ca1bf23468403ce549">cpart_servo::GetAboutInfo</a></div><div class="ttdeci">lxString GetAboutInfo(void) override</div><div class="ttdoc">Return the about information of part.</div><div class="ttdef"><b>Definition:</b> part_servo.h:43</div></div>
<div class="ttc" id="aclasscpart__servo_html_ac943dc8cf327494608d6540db5349760"><div class="ttname"><a href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">cpart_servo::input_pin</a></div><div class="ttdeci">unsigned char input_pin</div><div class="ttdoc">pulse input pin</div><div class="ttdef"><b>Definition:</b> part_servo.h:70</div></div>
<div class="ttc" id="aclasscpart__servo_html_aec280c6ce5b18601e15231a2f3622e6a"><div class="ttname"><a href="classcpart__servo.html#aec280c6ce5b18601e15231a2f3622e6a">cpart_servo::~cpart_servo</a></div><div class="ttdeci">~cpart_servo(void)</div><div class="ttdoc">destructor called once on part destruction</div><div class="ttdef"><b>Definition:</b> part_servo.cc:65</div></div>
<div class="ttc" id="aclasscpart__servo_html_af7c0accf52260ff6f9e150c5f9c632b1"><div class="ttname"><a href="classcpart__servo.html#af7c0accf52260ff6f9e150c5f9c632b1">cpart_servo::SetScale</a></div><div class="ttdeci">void SetScale(double scale) override</div><div class="ttdoc">Set the orientation to draw.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:264</div></div>
<div class="ttc" id="aclasscpart__servo_html_afb87939ab462851e162586d40991515c"><div class="ttname"><a href="classcpart__servo.html#afb87939ab462851e162586d40991515c">cpart_servo::Draw</a></div><div class="ttdeci">void Draw(void) override</div><div class="ttdoc">Called ever 100ms to draw part.</div><div class="ttdef"><b>Definition:</b> part_servo.cc:73</div></div>
<div class="ttc" id="aclasspart_html"><div class="ttname"><a href="classpart.html">part</a></div><div class="ttdoc">PART class.</div><div class="ttdef"><b>Definition:</b> part.h:36</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="pcode"></a>
part_servo.cc</h2>
<div class="fragment"><div class="line"><span class="comment">/* ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   PICsimLab - PIC laboratory simulator</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Copyright (c) : 2010-2020  Luis Claudio Gambôa Lopes</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">   the Free Software Foundation; either version 2, or (at your option)</span></div>
<div class="line"><span class="comment">   any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">   along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   For e-mail suggestions :  lcgamboa@yahoo.com</span></div>
<div class="line"><span class="comment">   ######################################################################## */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include&quot;../picsimlab1.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include&quot;../picsimlab4.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include&quot;../picsimlab5.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include&quot;part_servo.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* outputs */</span></div>
<div class="line"><span class="keyword">enum</span></div>
<div class="line">{</div>
<div class="line"> O_P1, O_AXIS</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classcpart__servo.html#a38f5b70c1f63626da3951a5ce57bc16f">cpart_servo::cpart_servo</a>(<span class="keywordtype">unsigned</span> x, <span class="keywordtype">unsigned</span> y)</div>
<div class="line">: font(9, lxFONTFAMILY_TELETYPE, lxFONTSTYLE_NORMAL, lxFONTWEIGHT_BOLD)</div>
<div class="line">{</div>
<div class="line"> X = x;</div>
<div class="line"> Y = y;</div>
<div class="line"> aways_update = 1;</div>
<div class="line"> input_pin = 0;</div>
<div class="line"> angle = 0;</div>
<div class="line"> angle_ = 0;</div>
<div class="line"> in_[0] = 0;</div>
<div class="line"> in_[1] = 0;</div>
<div class="line"> time = 0;</div>
<div class="line"> </div>
<div class="line"> ReadMaps ();</div>
<div class="line"> </div>
<div class="line"> lxImage image (&amp;Window5);</div>
<div class="line"> image.LoadFile (lxGetLocalFile(Window1.<a class="code" href="class_c_p_window1.html#a5ac98dc50ff5f47fd05ebd534d80d1f0">GetSharePath</a> () + lxT (<span class="stringliteral">&quot;parts/&quot;</span>) + GetPictureFileName ()), Orientation, Scale, Scale);</div>
<div class="line"> </div>
<div class="line"> Bitmap = <span class="keyword">new</span> lxBitmap (&amp;image, &amp;Window5);</div>
<div class="line"> image.Destroy ();</div>
<div class="line"> </div>
<div class="line"> image.LoadFile (lxGetLocalFile(Window1.<a class="code" href="class_c_p_window1.html#a5ac98dc50ff5f47fd05ebd534d80d1f0">GetSharePath</a> () + lxT (<span class="stringliteral">&quot;parts/&quot;</span>) + GetPictureFileName ()), Orientation, Scale, Scale);</div>
<div class="line"> BackGround = <span class="keyword">new</span> lxBitmap (&amp;image, &amp;Window5);</div>
<div class="line"> image.Destroy ();</div>
<div class="line"> </div>
<div class="line"> canvas.Create (Window5.GetWWidget (), Bitmap);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classcpart__servo.html#aec280c6ce5b18601e15231a2f3622e6a">cpart_servo::~cpart_servo</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="keyword">delete</span> <a class="code" href="classpart.html#a5edfdd836fc264f0e1047d002e4e7e18">Bitmap</a>;</div>
<div class="line"> <span class="keyword">delete</span> <a class="code" href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">BackGround</a>;</div>
<div class="line"> <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.Destroy ();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#afb87939ab462851e162586d40991515c">cpart_servo::Draw</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classpart.html#a4eb152fb7bf5a7ec09b93c7511f385d6">Update</a> = 0;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classpart.html#ac55cc5edacce49ba7abc9e4d0d1cc354">outputc</a>; i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">if</span> (<a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].update)<span class="comment">//only if need update</span></div>
<div class="line">    {</div>
<div class="line">     <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 0;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (!<a class="code" href="classpart.html#a4eb152fb7bf5a7ec09b93c7511f385d6">Update</a>)</div>
<div class="line">      {</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.SetBitmap (<a class="code" href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">BackGround</a>, 1.0, 1.0); <span class="comment">//FIXME draw servo error on scale or rotate</span></div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.Init (<a class="code" href="classpart.html#a26d28e6bfe04c985a20657958408005a">Scale</a>, <a class="code" href="classpart.html#a26d28e6bfe04c985a20657958408005a">Scale</a>, <a class="code" href="classpart.html#a712eee4f18b5651335989bd628518c9f">Orientation</a>);</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.SetFont (font);</div>
<div class="line">      }</div>
<div class="line">     <a class="code" href="classpart.html#a4eb152fb7bf5a7ec09b93c7511f385d6">Update</a>++; <span class="comment">//set to update buffer</span></div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (<a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].<span class="keywordtype">id</span> == O_P1)</div>
<div class="line">      {</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.SetFgColor (255, 255, 255);</div>
<div class="line">       <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a> == 0)</div>
<div class="line">        <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.RotatedText (<span class="stringliteral">&quot;NC&quot;</span>, <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].x1, <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].y1, 0);</div>
<div class="line">       <span class="keywordflow">else</span></div>
<div class="line">        <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.RotatedText (Window5.<a class="code" href="class_c_p_window5.html#a6f859826910014d1bc32d94d2130bbb9">GetPinName</a> (<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a>), <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].<a class="code" href="structoutput__t.html#a4a26c232a33f2387180a8bc0b6c078e7">x1</a>, <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].<a class="code" href="structoutput__t.html#a3ea90d25dafd4e3f279f3f541a956ffa">y1</a>, 0);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (<a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].<span class="keywordtype">id</span> == O_AXIS)</div>
<div class="line">      {</div>
<div class="line">       <span class="keywordtype">float</span> x2 = <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].<a class="code" href="structoutput__t.html#a4a26c232a33f2387180a8bc0b6c078e7">x1</a> + <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].r * sin (<a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a>);</div>
<div class="line">       <span class="keywordtype">float</span> y2 = <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].<a class="code" href="structoutput__t.html#a3ea90d25dafd4e3f279f3f541a956ffa">y1</a> - <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].r * cos (<a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a>);</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.SetFgColor (0, 0, 0);</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.SetLineWidth (20);</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.Line (<a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].x1, <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].y1, x2, y2);</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.SetFgColor (255, 255, 255);</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.SetLineWidth (18);</div>
<div class="line">       <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.Line (<a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].x1, <a class="code" href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">output</a>[i].y1, x2, y2);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classpart.html#a4eb152fb7bf5a7ec09b93c7511f385d6">Update</a>)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">canvas</a>.End ();</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a774812d1ea393ac0328de09efbe97490">cpart_servo::Process</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">const</span> picpin * ppins = Window5.GetPinsValues ();</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a> == 0)<span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[1] = <a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[0];</div>
<div class="line"> <a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[0] = ppins[<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a> - 1].value;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> ((<a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[0] == 1)&amp;&amp;(<a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[1] == 0))<span class="comment">//rise</span></div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classcpart__servo.html#a143b73817ed78ff25408bd0eec5f4755">time</a> = 0;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> ((<a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[0] == 0)&amp;&amp;(<a class="code" href="classcpart__servo.html#a840063c98f8a8635554d9f8a1e297181">in_</a>[1] == 1))<span class="comment">//low</span></div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a> = ((<a class="code" href="classcpart__servo.html#a143b73817ed78ff25408bd0eec5f4755">time</a> / Window1.<a class="code" href="class_c_p_window1.html#a5293ce669d8269ef2ecf2ed54fb3eb12">GetBoard</a> ()-&gt;<a class="code" href="classboard.html#a2c5a0def304361ca54f770b2cd9520fd">MGetInstClockFreq</a> ()) - 0.0015)*3141.59265359;</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a> &gt; M_PI / 2.0)<a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a> = M_PI / 2.0;</div>
<div class="line">   <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a> &lt; -M_PI / 2.0)<a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a> = -M_PI / 2.0;</div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classcpart__servo.html#a143b73817ed78ff25408bd0eec5f4755">time</a>++;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a5cd43fc2214c65bdfbac5291228f8376">cpart_servo::PostProcess</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> &gt; <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a>)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> -= 0.2;</div>
<div class="line">   <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> &lt; <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a>) <a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> = <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> &lt; <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a>)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> += 0.2;</div>
<div class="line">   <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> &gt; <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a>) <a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a> = <a class="code" href="classcpart__servo.html#a22893b0e5a587b655f947d0450964303">angle_</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classpart.html#a03d90e1490c5dfb116669ea11f90b740">output_ids</a>[O_AXIS]-&gt;value_f != <a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a>)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classpart.html#a03d90e1490c5dfb116669ea11f90b740">output_ids</a>[O_AXIS]-&gt;<a class="code" href="structoutput__t.html#a9b57cc8e6b609a849171298f1fcf1f9f">value_f</a> = <a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a>;</div>
<div class="line">   <a class="code" href="classpart.html#a03d90e1490c5dfb116669ea11f90b740">output_ids</a>[O_AXIS]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">   <a class="code" href="classpart.html#a03d90e1490c5dfb116669ea11f90b740">output_ids</a>[O_P1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">short</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a5fa49b34102d782755dd5f5ef172f13d">cpart_servo::get_in_id</a>(<span class="keywordtype">char</span> * name)</div>
<div class="line">{</div>
<div class="line"> printf (<span class="stringliteral">&quot;Erro input &#39;%s&#39; don&#39;t have a valid id! \n&quot;</span>, name);</div>
<div class="line"> <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">short</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a57b0dc4b8c939e2ea78065a03dda0bd3">cpart_servo::get_out_id</a>(<span class="keywordtype">char</span> * name)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PN_1&quot;</span>) == 0)<span class="keywordflow">return</span> O_P1;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;DG_AXIS&quot;</span>) == 0)<span class="keywordflow">return</span> O_AXIS;</div>
<div class="line"> </div>
<div class="line"> printf (<span class="stringliteral">&quot;Erro output &#39;%s&#39; don&#39;t have a valid id! \n&quot;</span>, name);</div>
<div class="line"> <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">lxString</div>
<div class="line"><a class="code" href="classcpart__servo.html#a4a16d8728aa01dc94f0b544d6b8aace0">cpart_servo::WritePreferences</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">char</span> prefs[256];</div>
<div class="line"> </div>
<div class="line"> sprintf (prefs, <span class="stringliteral">&quot;%hhu&quot;</span>, <a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">return</span> prefs;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a37bfdfaf3fadd46d34338be0a6ca34f7">cpart_servo::ReadPreferences</a>(lxString value)</div>
<div class="line">{</div>
<div class="line"> sscanf (value.c_str (), <span class="stringliteral">&quot;%hhu&quot;</span>, &amp;<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a>);</div>
<div class="line"> <a class="code" href="classcpart__servo.html#a5092323ea79d9f6152f9e5eaf65f7ee7">RegisterRemoteControl</a> ();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a5092323ea79d9f6152f9e5eaf65f7ee7">cpart_servo::RegisterRemoteControl</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <a class="code" href="classpart.html#a03d90e1490c5dfb116669ea11f90b740">output_ids</a>[O_AXIS]-&gt;<a class="code" href="structoutput__t.html#a394c193a9f75a821997918c3fe8525a5">status</a> = (<span class="keywordtype">void</span> *) &amp;<a class="code" href="classcpart__servo.html#a0af2e1168aeb456ba1f6a0a1511c1019">angle</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a4a1e164fd0f4145fafe870f5f28f350a">cpart_servo::ConfigurePropertiesWindow</a>(CPWindow * WProp)</div>
<div class="line">{</div>
<div class="line"> lxString Items = Window5.<a class="code" href="class_c_p_window5.html#ab012f0ddc5fed1566f4b7ab53eb62be4">GetPinsNames</a> ();</div>
<div class="line"> lxString spin;</div>
<div class="line"> </div>
<div class="line"> ((CCombo*) WProp-&gt;GetChildByName (<span class="stringliteral">&quot;combo1&quot;</span>))-&gt;SetItems (Items);</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a> == 0)</div>
<div class="line">  ((CCombo*) WProp-&gt;GetChildByName (<span class="stringliteral">&quot;combo1&quot;</span>))-&gt;SetText (<span class="stringliteral">&quot;0  NC&quot;</span>);</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">   spin = Window5.<a class="code" href="class_c_p_window5.html#a6f859826910014d1bc32d94d2130bbb9">GetPinName</a> (<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a>);</div>
<div class="line">   ((CCombo*) WProp-&gt;GetChildByName (<span class="stringliteral">&quot;combo1&quot;</span>))-&gt;SetText (itoa (<a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a>) + <span class="stringliteral">&quot;  &quot;</span> + spin);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> ((CButton*) WProp-&gt;GetChildByName (<span class="stringliteral">&quot;button1&quot;</span>))-&gt;<a class="code" href="classpart.html#ad99e90d6389a2cbbca423ec7e9371f49">EvMouseButtonRelease</a> = EVMOUSEBUTTONRELEASE &amp; CPWindow5::PropButtonRelease;</div>
<div class="line"> ((CButton*) WProp-&gt;GetChildByName (<span class="stringliteral">&quot;button1&quot;</span>))-&gt;SetTag (1);</div>
<div class="line"> </div>
<div class="line"> ((CButton*) WProp-&gt;GetChildByName (<span class="stringliteral">&quot;button2&quot;</span>))-&gt;<a class="code" href="classpart.html#ad99e90d6389a2cbbca423ec7e9371f49">EvMouseButtonRelease</a> = EVMOUSEBUTTONRELEASE &amp; CPWindow5::PropButtonRelease;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#a1eac73056884d0a33e66bb850e4827a3">cpart_servo::ReadPropertiesWindow</a>(CPWindow * WProp)</div>
<div class="line">{</div>
<div class="line"> <a class="code" href="classcpart__servo.html#ac943dc8cf327494608d6540db5349760">input_pin</a> = atoi (((CCombo*) WProp-&gt;GetChildByName (<span class="stringliteral">&quot;combo1&quot;</span>))-&gt;GetText ());</div>
<div class="line"> <a class="code" href="classcpart__servo.html#a5092323ea79d9f6152f9e5eaf65f7ee7">RegisterRemoteControl</a> ();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#ac20457f24fcbfea16c0b8bcbc78d4faf">cpart_servo::SetOrientation</a>(<span class="keywordtype">int</span> orientation)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classpart.html#a712eee4f18b5651335989bd628518c9f">Orientation</a> == orientation)<span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classpart.html#a2e5becd7108e8fab479a0a47a013c460">part::SetOrientation</a> (orientation);</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">delete</span> <a class="code" href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">BackGround</a>;</div>
<div class="line"> </div>
<div class="line"> lxImage image (&amp;Window5);</div>
<div class="line"> </div>
<div class="line"> image.LoadFile (lxGetLocalFile(Window1.<a class="code" href="class_c_p_window1.html#a5ac98dc50ff5f47fd05ebd534d80d1f0">GetSharePath</a> () + lxT (<span class="stringliteral">&quot;parts/&quot;</span>) + <a class="code" href="classpart.html#acb4a5752560f9b0c399e7e8b2807bea3">GetPictureFileName</a> ()), <a class="code" href="classpart.html#a712eee4f18b5651335989bd628518c9f">Orientation</a>, <a class="code" href="classpart.html#a26d28e6bfe04c985a20657958408005a">Scale</a>, <a class="code" href="classpart.html#a26d28e6bfe04c985a20657958408005a">Scale</a>);</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">BackGround</a> = <span class="keyword">new</span> lxBitmap (&amp;image, &amp;Window5);</div>
<div class="line"> </div>
<div class="line"> image.Destroy ();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcpart__servo.html#af7c0accf52260ff6f9e150c5f9c632b1">cpart_servo::SetScale</a>(<span class="keywordtype">double</span> scale)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classpart.html#a26d28e6bfe04c985a20657958408005a">Scale</a> == scale)<span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classpart.html#ab03241df923fde44292d847d034af546">part::SetScale</a> (scale);</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">delete</span> <a class="code" href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">BackGround</a>;</div>
<div class="line"> </div>
<div class="line"> lxImage image (&amp;Window5);</div>
<div class="line"> </div>
<div class="line"> image.LoadFile (lxGetLocalFile(Window1.<a class="code" href="class_c_p_window1.html#a5ac98dc50ff5f47fd05ebd534d80d1f0">GetSharePath</a> () + lxT (<span class="stringliteral">&quot;parts/&quot;</span>) + <a class="code" href="classpart.html#acb4a5752560f9b0c399e7e8b2807bea3">GetPictureFileName</a> ()), <a class="code" href="classpart.html#a712eee4f18b5651335989bd628518c9f">Orientation</a>, <a class="code" href="classpart.html#a26d28e6bfe04c985a20657958408005a">Scale</a>, <a class="code" href="classpart.html#a26d28e6bfe04c985a20657958408005a">Scale</a>);</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classcpart__servo.html#a9b4c8f6557bae63ba5645c4aeb31a519">BackGround</a> = <span class="keyword">new</span> lxBitmap (&amp;image, &amp;Window5);</div>
<div class="line"> </div>
<div class="line"> image.Destroy ();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Register the part in PICSimLab spare parts list</span></div>
<div class="line">part_init(PART_SERVO_Name, <a class="code" href="classcpart__servo.html">cpart_servo</a>, <span class="stringliteral">&quot;Output&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="aclass_c_p_window1_html_a5293ce669d8269ef2ecf2ed54fb3eb12"><div class="ttname"><a href="class_c_p_window1.html#a5293ce669d8269ef2ecf2ed54fb3eb12">CPWindow1::GetBoard</a></div><div class="ttdeci">board * GetBoard(void)</div><div class="ttdoc">Return a pointer to board object.</div><div class="ttdef"><b>Definition:</b> picsimlab1.cc:1332</div></div>
<div class="ttc" id="aclass_c_p_window1_html_a5ac98dc50ff5f47fd05ebd534d80d1f0"><div class="ttname"><a href="class_c_p_window1.html#a5ac98dc50ff5f47fd05ebd534d80d1f0">CPWindow1::GetSharePath</a></div><div class="ttdeci">lxString GetSharePath(void)</div><div class="ttdoc">Get the file path of resources.</div><div class="ttdef"><b>Definition:</b> picsimlab1.h:180</div></div>
<div class="ttc" id="aclass_c_p_window5_html_a6f859826910014d1bc32d94d2130bbb9"><div class="ttname"><a href="class_c_p_window5.html#a6f859826910014d1bc32d94d2130bbb9">CPWindow5::GetPinName</a></div><div class="ttdeci">lxString GetPinName(unsigned char pin)</div><div class="ttdoc">Return the name of one pin.</div><div class="ttdef"><b>Definition:</b> picsimlab5.cc:1257</div></div>
<div class="ttc" id="aclass_c_p_window5_html_ab012f0ddc5fed1566f4b7ab53eb62be4"><div class="ttname"><a href="class_c_p_window5.html#ab012f0ddc5fed1566f4b7ab53eb62be4">CPWindow5::GetPinsNames</a></div><div class="ttdeci">lxString GetPinsNames(void)</div><div class="ttdoc">Return the name of all pins.</div><div class="ttdef"><b>Definition:</b> picsimlab5.cc:1218</div></div>
<div class="ttc" id="aclassboard_html_a2c5a0def304361ca54f770b2cd9520fd"><div class="ttname"><a href="classboard.html#a2c5a0def304361ca54f770b2cd9520fd">board::MGetInstClockFreq</a></div><div class="ttdeci">virtual float MGetInstClockFreq(void)=0</div><div class="ttdoc">board microcontroller get cpu internal clock (in PIC frequency/4)</div></div>
<div class="ttc" id="aclasspart_html_a03d90e1490c5dfb116669ea11f90b740"><div class="ttname"><a href="classpart.html#a03d90e1490c5dfb116669ea11f90b740">part::output_ids</a></div><div class="ttdeci">output_t * output_ids[100]</div><div class="ttdoc">output map elements by id order</div><div class="ttdef"><b>Definition:</b> part.h:337</div></div>
<div class="ttc" id="aclasspart_html_a074fcb74e58bd5f199ce043a500d1c69"><div class="ttname"><a href="classpart.html#a074fcb74e58bd5f199ce043a500d1c69">part::output</a></div><div class="ttdeci">output_t output[100]</div><div class="ttdoc">output map elements</div><div class="ttdef"><b>Definition:</b> part.h:336</div></div>
<div class="ttc" id="aclasspart_html_a26d28e6bfe04c985a20657958408005a"><div class="ttname"><a href="classpart.html#a26d28e6bfe04c985a20657958408005a">part::Scale</a></div><div class="ttdeci">double Scale</div><div class="ttdoc">scale to draw part</div><div class="ttdef"><b>Definition:</b> part.h:348</div></div>
<div class="ttc" id="aclasspart_html_a2e5becd7108e8fab479a0a47a013c460"><div class="ttname"><a href="classpart.html#a2e5becd7108e8fab479a0a47a013c460">part::SetOrientation</a></div><div class="ttdeci">virtual void SetOrientation(int orientation)</div><div class="ttdoc">Set the orientation to draw.</div><div class="ttdef"><b>Definition:</b> part.cc:351</div></div>
<div class="ttc" id="aclasspart_html_a4adcfbd9da4f9e196fd7f50ce829d817"><div class="ttname"><a href="classpart.html#a4adcfbd9da4f9e196fd7f50ce829d817">part::canvas</a></div><div class="ttdeci">CCanvas canvas</div><div class="ttdoc">Internal Canvas to draw in bitmap.</div><div class="ttdef"><b>Definition:</b> part.h:345</div></div>
<div class="ttc" id="aclasspart_html_a4eb152fb7bf5a7ec09b93c7511f385d6"><div class="ttname"><a href="classpart.html#a4eb152fb7bf5a7ec09b93c7511f385d6">part::Update</a></div><div class="ttdeci">unsigned int Update</div><div class="ttdoc">part need draw Update</div><div class="ttdef"><b>Definition:</b> part.h:349</div></div>
<div class="ttc" id="aclasspart_html_a5edfdd836fc264f0e1047d002e4e7e18"><div class="ttname"><a href="classpart.html#a5edfdd836fc264f0e1047d002e4e7e18">part::Bitmap</a></div><div class="ttdeci">lxBitmap * Bitmap</div><div class="ttdoc">Internal Bitmap</div><div class="ttdef"><b>Definition:</b> part.h:344</div></div>
<div class="ttc" id="aclasspart_html_a712eee4f18b5651335989bd628518c9f"><div class="ttname"><a href="classpart.html#a712eee4f18b5651335989bd628518c9f">part::Orientation</a></div><div class="ttdeci">int Orientation</div><div class="ttdoc">orientation to draw part</div><div class="ttdef"><b>Definition:</b> part.h:347</div></div>
<div class="ttc" id="aclasspart_html_ab03241df923fde44292d847d034af546"><div class="ttname"><a href="classpart.html#ab03241df923fde44292d847d034af546">part::SetScale</a></div><div class="ttdeci">virtual void SetScale(double scale)</div><div class="ttdoc">Set the orientation to draw.</div><div class="ttdef"><b>Definition:</b> part.cc:385</div></div>
<div class="ttc" id="aclasspart_html_ac55cc5edacce49ba7abc9e4d0d1cc354"><div class="ttname"><a href="classpart.html#ac55cc5edacce49ba7abc9e4d0d1cc354">part::outputc</a></div><div class="ttdeci">int outputc</div><div class="ttdoc">output map elements counter</div><div class="ttdef"><b>Definition:</b> part.h:339</div></div>
<div class="ttc" id="aclasspart_html_acb4a5752560f9b0c399e7e8b2807bea3"><div class="ttname"><a href="classpart.html#acb4a5752560f9b0c399e7e8b2807bea3">part::GetPictureFileName</a></div><div class="ttdeci">virtual lxString GetPictureFileName(void)</div><div class="ttdoc">Return the filename of part picture.</div><div class="ttdef"><b>Definition:</b> part.cc:484</div></div>
<div class="ttc" id="aclasspart_html_ad99e90d6389a2cbbca423ec7e9371f49"><div class="ttname"><a href="classpart.html#ad99e90d6389a2cbbca423ec7e9371f49">part::EvMouseButtonRelease</a></div><div class="ttdeci">virtual void EvMouseButtonRelease(uint button, uint x, uint y, uint state)</div><div class="ttdoc">Event handler on the part.</div><div class="ttdef"><b>Definition:</b> part.h:133</div></div>
<div class="ttc" id="astructoutput__t_html_a394c193a9f75a821997918c3fe8525a5"><div class="ttname"><a href="structoutput__t.html#a394c193a9f75a821997918c3fe8525a5">output_t::status</a></div><div class="ttdeci">void * status</div><div class="ttdoc">rcontrol status</div><div class="ttdef"><b>Definition:</b> board.h:75</div></div>
<div class="ttc" id="astructoutput__t_html_a3ea90d25dafd4e3f279f3f541a956ffa"><div class="ttname"><a href="structoutput__t.html#a3ea90d25dafd4e3f279f3f541a956ffa">output_t::y1</a></div><div class="ttdeci">unsigned int y1</div><div class="ttdoc">y1 position</div><div class="ttdef"><b>Definition:</b> board.h:68</div></div>
<div class="ttc" id="astructoutput__t_html_a4a26c232a33f2387180a8bc0b6c078e7"><div class="ttname"><a href="structoutput__t.html#a4a26c232a33f2387180a8bc0b6c078e7">output_t::x1</a></div><div class="ttdeci">unsigned int x1</div><div class="ttdoc">x1 position</div><div class="ttdef"><b>Definition:</b> board.h:66</div></div>
<div class="ttc" id="astructoutput__t_html_a9b57cc8e6b609a849171298f1fcf1f9f"><div class="ttname"><a href="structoutput__t.html#a9b57cc8e6b609a849171298f1fcf1f9f">output_t::value_f</a></div><div class="ttdeci">float value_f</div><div class="ttdoc">updated value float</div><div class="ttdef"><b>Definition:</b> board.h:80</div></div>
<div class="ttc" id="astructoutput__t_html_aa91b1205a6823abba2269f91bb87863d"><div class="ttname"><a href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">output_t::update</a></div><div class="ttdeci">unsigned char update</div><div class="ttdoc">need draw update</div><div class="ttdef"><b>Definition:</b> board.h:76</div></div>
</div><!-- fragment --><h1><a class="anchor" id="boardex"></a>
Board example</h1>
<h2><a class="anchor" id="binc"></a>
board_x.h</h2>
<div class="fragment"><div class="line"><span class="comment">/* ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   PICsimLab - PIC laboratory simulator</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Copyright (c) : 2015-2021  Luis Claudio Gambôa Lopes</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">   the Free Software Foundation; either version 2, or (at your option)</span></div>
<div class="line"><span class="comment">   any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">   along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   For e-mail suggestions :  lcgamboa@yahoo.com</span></div>
<div class="line"><span class="comment">   ######################################################################## */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef BOARD_x_H</span></div>
<div class="line"><span class="preprocessor">#define BOARD_x_H</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include&lt;lxrad.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;bsim_picsim.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define BOARD_x_Name &quot;X&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//new board class must be derived from board class defined in board.h</span></div>
<div class="line"><span class="keyword">class </span><a class="code" href="classcboard__x.html">cboard_x</a>:<span class="keyword">public</span> <a class="code" href="classbsim__picsim.html">bsim_picsim</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p_BT1;           <span class="comment">//first board push button in RD0</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p_BT2;           <span class="comment">//second board switch in RD1  </span></div>
<div class="line">     </div>
<div class="line">     <span class="comment">//value of potentiometer</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pot1;</div>
<div class="line">     <span class="comment">//flag to control if potentiometer is active</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> active;</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//controls to be added in simulator window </span></div>
<div class="line">     CGauge *gauge1;   <span class="comment">//gauge to show mean value of RB0</span></div>
<div class="line">     CGauge *gauge2;   <span class="comment">//gauge to show mean value of RB1</span></div>
<div class="line">     CLabel *label2;   <span class="comment">//label of gauge RB0</span></div>
<div class="line">     CLabel *label3;   <span class="comment">//label of gauge RB1</span></div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Register controls for remote interface called once on board creation </span></div>
<div class="line">     <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a9c1664ce551c79209b4e6dc9d0ed8730">RegisterRemoteControl</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;  </div>
<div class="line">     </div>
<div class="line">     lxColor color1;<span class="comment">//LEDs color 1</span></div>
<div class="line">     lxColor color2;<span class="comment">//LEDs color 2   </span></div>
<div class="line">     lxFont font;</div>
<div class="line">   <span class="keyword">public</span>:</div>
<div class="line">      <span class="comment">//Constructor called once on board creation </span></div>
<div class="line">      <a class="code" href="classcboard__x.html">cboard_x</a>(<span class="keywordtype">void</span>);</div>
<div class="line">      <span class="comment">//Destructor called once on board destruction </span></div>
<div class="line">      ~<a class="code" href="classcboard__x.html">cboard_x</a>(<span class="keywordtype">void</span>); </div>
<div class="line">      <span class="comment">//Return the board name</span></div>
<div class="line">      lxString <a class="code" href="classcboard__x.html#a350e7f7b3a7edd49c2021c30cc3a18f4">GetName</a>(<span class="keywordtype">void</span>)<span class="keyword">  override </span>{<span class="keywordflow">return</span> lxT(BOARD_x_Name); }; </div>
<div class="line">      <span class="comment">//Return the about info of board</span></div>
<div class="line">      lxString <a class="code" href="classcboard__x.html#a3d75167fedb903b74a8920476214f701">GetAboutInfo</a>(<span class="keywordtype">void</span>)<span class="keyword"> override </span>{<span class="keywordflow">return</span> lxT(<span class="stringliteral">&quot;L.C. Gamboa \n &lt;lcgamboa@yahoo.com&gt;&quot;</span>);};</div>
<div class="line">      <span class="comment">//Called ever 100ms to draw board</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a18ebbd336dc27b64c0fdcc6a5d580ee4">Draw</a>(CDraw *draw) <span class="keyword">override</span>;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a6337aae979579d9d180026dfcd2c55c0">Run_CPU</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Return a list of board supported microcontrollers</span></div>
<div class="line">      lxString <a class="code" href="classcboard__x.html#a4e642d592813f132be2227a4af97bb3e">GetSupportedDevices</a>(<span class="keywordtype">void</span>)<span class="keyword"> override </span>{<span class="keywordflow">return</span> lxT(<span class="stringliteral">&quot;PIC16F877A,PIC18F4550,PIC18F4620,&quot;</span>);};</div>
<div class="line">      <span class="comment">//Reset board status</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a6f87b4f00b9297a5893a805820c4a436">Reset</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Event on the board</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a54f0b84ecd3973bdd3f7d8b7d13cc0b9">EvMouseButtonPress</a>(uint button, uint x, uint y,uint state) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Event on the board</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#abb94877b3a91eb371b3b20e2e9cebcce">EvMouseButtonRelease</a>(uint button, uint x, uint y,uint state) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Event on the board</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#acfd3a83c6a0ece11eb8d88dd9fa102f9">EvMouseMove</a>(uint button, uint x, uint y, uint state) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Event on the board</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a3db74c02199e114e22f7a7a5b4e3dd96">EvKeyPress</a>(uint key,uint mask) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Event on the board</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#aef95af41c7e6c527dfe9e522912a19a2">EvKeyRelease</a>(uint key,uint mask) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Called ever 1s to refresh status</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a1492d042e89665dba3924b193f5bf9cc">RefreshStatus</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Called to save board preferences in configuration file</span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a5603baefc099825eeb53634ece32b2f8">WritePreferences</a>(<span class="keywordtype">void</span>) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//Called whe configuration file load  preferences </span></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classcboard__x.html#a696180daddb7dfc9b5bf5ad45fca0124">ReadPreferences</a>(<span class="keywordtype">char</span> *name,<span class="keywordtype">char</span> *value) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//return the input ids numbers of names used in input map</span></div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classcboard__x.html#a4a96bccccb853f6f8b367db3e63d693f">get_in_id</a>(<span class="keywordtype">char</span> * name) <span class="keyword">override</span>;</div>
<div class="line">      <span class="comment">//return the output ids numbers of names used in output map</span></div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classcboard__x.html#a4f4460d4ad4d82cc885312b4bfedcd87">get_out_id</a>(<span class="keywordtype">char</span> * name) <span class="keyword">override</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif  </span><span class="comment">/* BOARD_x_H */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="ttc" id="aclassbsim__picsim_html"><div class="ttname"><a href="classbsim__picsim.html">bsim_picsim</a></div><div class="ttdef"><b>Definition:</b> bsim_picsim.h:34</div></div>
<div class="ttc" id="aclasscboard__x_html"><div class="ttname"><a href="classcboard__x.html">cboard_x</a></div><div class="ttdef"><b>Definition:</b> board_x.h:37</div></div>
<div class="ttc" id="aclasscboard__x_html_a1492d042e89665dba3924b193f5bf9cc"><div class="ttname"><a href="classcboard__x.html#a1492d042e89665dba3924b193f5bf9cc">cboard_x::RefreshStatus</a></div><div class="ttdeci">void RefreshStatus(void) override</div><div class="ttdoc">Called ever 1s to refresh status.</div><div class="ttdef"><b>Definition:</b> board_x.cc:234</div></div>
<div class="ttc" id="aclasscboard__x_html_a18ebbd336dc27b64c0fdcc6a5d580ee4"><div class="ttname"><a href="classcboard__x.html#a18ebbd336dc27b64c0fdcc6a5d580ee4">cboard_x::Draw</a></div><div class="ttdeci">void Draw(CDraw *draw) override</div><div class="ttdoc">Called ever 100ms to draw board.</div><div class="ttdef"><b>Definition:</b> board_x.cc:486</div></div>
<div class="ttc" id="aclasscboard__x_html_a350e7f7b3a7edd49c2021c30cc3a18f4"><div class="ttname"><a href="classcboard__x.html#a350e7f7b3a7edd49c2021c30cc3a18f4">cboard_x::GetName</a></div><div class="ttdeci">lxString GetName(void) override</div><div class="ttdoc">Get board name registered in PICSimLab</div><div class="ttdef"><b>Definition:</b> board_x.h:65</div></div>
<div class="ttc" id="aclasscboard__x_html_a3d75167fedb903b74a8920476214f701"><div class="ttname"><a href="classcboard__x.html#a3d75167fedb903b74a8920476214f701">cboard_x::GetAboutInfo</a></div><div class="ttdeci">lxString GetAboutInfo(void) override</div><div class="ttdoc">Return the about information of part.</div><div class="ttdef"><b>Definition:</b> board_x.h:67</div></div>
<div class="ttc" id="aclasscboard__x_html_a3db74c02199e114e22f7a7a5b4e3dd96"><div class="ttname"><a href="classcboard__x.html#a3db74c02199e114e22f7a7a5b4e3dd96">cboard_x::EvKeyPress</a></div><div class="ttdeci">void EvKeyPress(uint key, uint mask) override</div><div class="ttdoc">Event on the board.</div><div class="ttdef"><b>Definition:</b> board_x.cc:302</div></div>
<div class="ttc" id="aclasscboard__x_html_a4a96bccccb853f6f8b367db3e63d693f"><div class="ttname"><a href="classcboard__x.html#a4a96bccccb853f6f8b367db3e63d693f">cboard_x::get_in_id</a></div><div class="ttdeci">unsigned short get_in_id(char *name) override</div><div class="ttdoc">return the input ids numbers of names used in input map</div><div class="ttdef"><b>Definition:</b> board_x.cc:61</div></div>
<div class="ttc" id="aclasscboard__x_html_a4e642d592813f132be2227a4af97bb3e"><div class="ttname"><a href="classcboard__x.html#a4e642d592813f132be2227a4af97bb3e">cboard_x::GetSupportedDevices</a></div><div class="ttdeci">lxString GetSupportedDevices(void) override</div><div class="ttdoc">Return a list of supported microcontrollers.</div><div class="ttdef"><b>Definition:</b> board_x.h:72</div></div>
<div class="ttc" id="aclasscboard__x_html_a4f4460d4ad4d82cc885312b4bfedcd87"><div class="ttname"><a href="classcboard__x.html#a4f4460d4ad4d82cc885312b4bfedcd87">cboard_x::get_out_id</a></div><div class="ttdeci">unsigned short get_out_id(char *name) override</div><div class="ttdoc">return the output ids numbers of names used in output map</div><div class="ttdef"><b>Definition:</b> board_x.cc:77</div></div>
<div class="ttc" id="aclasscboard__x_html_a54f0b84ecd3973bdd3f7d8b7d13cc0b9"><div class="ttname"><a href="classcboard__x.html#a54f0b84ecd3973bdd3f7d8b7d13cc0b9">cboard_x::EvMouseButtonPress</a></div><div class="ttdeci">void EvMouseButtonPress(uint button, uint x, uint y, uint state) override</div><div class="ttdoc">Event on the board.</div><div class="ttdef"><b>Definition:</b> board_x.cc:337</div></div>
<div class="ttc" id="aclasscboard__x_html_a5603baefc099825eeb53634ece32b2f8"><div class="ttname"><a href="classcboard__x.html#a5603baefc099825eeb53634ece32b2f8">cboard_x::WritePreferences</a></div><div class="ttdeci">void WritePreferences(void) override</div><div class="ttdoc">Called to save board preferences in configuration file.</div><div class="ttdef"><b>Definition:</b> board_x.cc:255</div></div>
<div class="ttc" id="aclasscboard__x_html_a6337aae979579d9d180026dfcd2c55c0"><div class="ttname"><a href="classcboard__x.html#a6337aae979579d9d180026dfcd2c55c0">cboard_x::Run_CPU</a></div><div class="ttdeci">void Run_CPU(void) override</div><div class="ttdoc">Paralle thread called ever 100ms to run cpu code.</div><div class="ttdef"><b>Definition:</b> board_x.cc:637</div></div>
<div class="ttc" id="aclasscboard__x_html_a696180daddb7dfc9b5bf5ad45fca0124"><div class="ttname"><a href="classcboard__x.html#a696180daddb7dfc9b5bf5ad45fca0124">cboard_x::ReadPreferences</a></div><div class="ttdeci">void ReadPreferences(char *name, char *value) override</div><div class="ttdoc">Called whe configuration file load preferences.</div><div class="ttdef"><b>Definition:</b> board_x.cc:270</div></div>
<div class="ttc" id="aclasscboard__x_html_a6f87b4f00b9297a5893a805820c4a436"><div class="ttname"><a href="classcboard__x.html#a6f87b4f00b9297a5893a805820c4a436">cboard_x::Reset</a></div><div class="ttdeci">void Reset(void) override</div><div class="ttdoc">Reset board status.</div><div class="ttdef"><b>Definition:</b> board_x.cc:178</div></div>
<div class="ttc" id="aclasscboard__x_html_a9c1664ce551c79209b4e6dc9d0ed8730"><div class="ttname"><a href="classcboard__x.html#a9c1664ce551c79209b4e6dc9d0ed8730">cboard_x::RegisterRemoteControl</a></div><div class="ttdeci">void RegisterRemoteControl(void) override</div><div class="ttdoc">Register remote control variables.</div><div class="ttdef"><b>Definition:</b> board_x.cc:212</div></div>
<div class="ttc" id="aclasscboard__x_html_abb94877b3a91eb371b3b20e2e9cebcce"><div class="ttname"><a href="classcboard__x.html#abb94877b3a91eb371b3b20e2e9cebcce">cboard_x::EvMouseButtonRelease</a></div><div class="ttdeci">void EvMouseButtonRelease(uint button, uint x, uint y, uint state) override</div><div class="ttdoc">Event on the board.</div><div class="ttdef"><b>Definition:</b> board_x.cc:437</div></div>
<div class="ttc" id="aclasscboard__x_html_acfd3a83c6a0ece11eb8d88dd9fa102f9"><div class="ttname"><a href="classcboard__x.html#acfd3a83c6a0ece11eb8d88dd9fa102f9">cboard_x::EvMouseMove</a></div><div class="ttdeci">void EvMouseMove(uint button, uint x, uint y, uint state) override</div><div class="ttdoc">Event on the board.</div><div class="ttdef"><b>Definition:</b> board_x.cc:407</div></div>
<div class="ttc" id="aclasscboard__x_html_aef95af41c7e6c527dfe9e522912a19a2"><div class="ttname"><a href="classcboard__x.html#aef95af41c7e6c527dfe9e522912a19a2">cboard_x::EvKeyRelease</a></div><div class="ttdeci">void EvKeyRelease(uint key, uint mask) override</div><div class="ttdoc">Event on the board.</div><div class="ttdef"><b>Definition:</b> board_x.cc:323</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="bcode"></a>
board_x.cc</h2>
<div class="fragment"><div class="line"><span class="comment">/* ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   PICsimLab - PIC laboratory simulator</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   ########################################################################</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Copyright (c) : 2015-2021  Luis Claudio Gambôa Lopes</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">   the Free Software Foundation; either version 2, or (at your option)</span></div>
<div class="line"><span class="comment">   any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">   along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   For e-mail suggestions :  lcgamboa@yahoo.com</span></div>
<div class="line"><span class="comment">   ######################################################################## */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//include files</span></div>
<div class="line"><span class="preprocessor">#include&quot;../picsimlab1.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include&quot;../picsimlab4.h&quot;</span> <span class="comment">//Oscilloscope</span></div>
<div class="line"><span class="preprocessor">#include&quot;../picsimlab5.h&quot;</span> <span class="comment">//Spare Parts</span></div>
<div class="line"><span class="preprocessor">#include&quot;board_x.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* ids of inputs of input map*/</span></div>
<div class="line"><span class="keyword">enum</span></div>
<div class="line">{</div>
<div class="line"> I_POT1, <span class="comment">//potentiometer   </span></div>
<div class="line"> I_ICSP, <span class="comment">//ICSP connector</span></div>
<div class="line"> I_PWR, <span class="comment">//Power button</span></div>
<div class="line"> I_RST, <span class="comment">//Reset button</span></div>
<div class="line"> I_BD0, <span class="comment">//RD0 push button</span></div>
<div class="line"> I_SD1 <span class="comment">//RD1 switch</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* ids of outputs of output map*/</span></div>
<div class="line"><span class="keyword">enum</span></div>
<div class="line">{</div>
<div class="line"> O_POT1, <span class="comment">//potentiometer  </span></div>
<div class="line"> O_RST, <span class="comment">//Reset button</span></div>
<div class="line"> O_SD1, <span class="comment">//switch position (On/Off)</span></div>
<div class="line"> O_LD0, <span class="comment">//LED on RD0 push button</span></div>
<div class="line"> O_LD1, <span class="comment">//LED on RD1 switch</span></div>
<div class="line"> O_LPWR, <span class="comment">//Power LED</span></div>
<div class="line"> O_RB0, <span class="comment">//LED on RB0 output</span></div>
<div class="line"> O_RB1, <span class="comment">//LED on RB1 output</span></div>
<div class="line"> O_BD0, <span class="comment">//RD1 switch     </span></div>
<div class="line"> O_CPU <span class="comment">//CPU name</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">//return the input ids numbers of names used in input map</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">short</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a4a96bccccb853f6f8b367db3e63d693f">cboard_x::get_in_id</a>(<span class="keywordtype">char</span> * name)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PG_ICSP&quot;</span>) == 0)<span class="keywordflow">return</span> I_ICSP;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;SW_PWR&quot;</span>) == 0)<span class="keywordflow">return</span> I_PWR;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PB_RST&quot;</span>) == 0)<span class="keywordflow">return</span> I_RST;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PB_D0&quot;</span>) == 0)<span class="keywordflow">return</span> I_BD0;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;SW_D1&quot;</span>) == 0)<span class="keywordflow">return</span> I_SD1;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PO_1&quot;</span>) == 0)<span class="keywordflow">return</span> I_POT1;</div>
<div class="line"> </div>
<div class="line"> printf (<span class="stringliteral">&quot;Error input &#39;%s&#39; don&#39;t have a valid id! \n&quot;</span>, name);</div>
<div class="line"> <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//return the output ids numbers of names used in output map</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">short</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a4f4460d4ad4d82cc885312b4bfedcd87">cboard_x::get_out_id</a>(<span class="keywordtype">char</span> * name)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;SW_D1&quot;</span>) == 0)<span class="keywordflow">return</span> O_SD1;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;LD_LD0&quot;</span>) == 0)<span class="keywordflow">return</span> O_LD0;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;LD_LD1&quot;</span>) == 0)<span class="keywordflow">return</span> O_LD1;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;LD_LPWR&quot;</span>) == 0)<span class="keywordflow">return</span> O_LPWR;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;LD_RB1&quot;</span>) == 0)<span class="keywordflow">return</span> O_RB1;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;LD_RB0&quot;</span>) == 0)<span class="keywordflow">return</span> O_RB0;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PB_D0&quot;</span>) == 0)<span class="keywordflow">return</span> O_BD0;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PO_1&quot;</span>) == 0)<span class="keywordflow">return</span> O_POT1;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;PB_RST&quot;</span>) == 0)<span class="keywordflow">return</span> O_RST;</div>
<div class="line"> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;IC_CPU&quot;</span>) == 0)<span class="keywordflow">return</span> O_CPU;</div>
<div class="line"> </div>
<div class="line"> printf (<span class="stringliteral">&quot;Error output &#39;%s&#39; don&#39;t have a valid id! \n&quot;</span>, name);</div>
<div class="line"> <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Constructor called once on board creation </span></div>
<div class="line"> </div>
<div class="line">cboard_x::cboard_x(<span class="keywordtype">void</span>) :</div>
<div class="line">font(10, lxFONTFAMILY_TELETYPE, lxFONTSTYLE_NORMAL, lxFONTWEIGHT_BOLD)</div>
<div class="line">{</div>
<div class="line"> Proc = <span class="stringliteral">&quot;PIC18F4550&quot;</span>; <span class="comment">//default microcontroller if none defined in preferences</span></div>
<div class="line"> ReadMaps (); <span class="comment">//Read input and output board maps</span></div>
<div class="line"> </div>
<div class="line"> pot1 = 100;</div>
<div class="line"> </div>
<div class="line"> active = 0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//controls properties and creation</span></div>
<div class="line"> <span class="comment">//gauge1</span></div>
<div class="line"> gauge1 = <span class="keyword">new</span> CGauge ();</div>
<div class="line"> gauge1-&gt;SetFOwner (&amp;Window1);</div>
<div class="line"> gauge1-&gt;SetName (lxT (<span class="stringliteral">&quot;gauge1_px&quot;</span>));</div>
<div class="line"> gauge1-&gt;SetX (13);</div>
<div class="line"> gauge1-&gt;SetY (382 - 160);</div>
<div class="line"> gauge1-&gt;SetWidth (140);</div>
<div class="line"> gauge1-&gt;SetHeight (20);</div>
<div class="line"> gauge1-&gt;SetEnable (1);</div>
<div class="line"> gauge1-&gt;SetVisible (1);</div>
<div class="line"> gauge1-&gt;SetRange (100);</div>
<div class="line"> gauge1-&gt;SetValue (0);</div>
<div class="line"> gauge1-&gt;SetType (4);</div>
<div class="line"> Window1.CreateChild (gauge1);</div>
<div class="line"> <span class="comment">//gauge2</span></div>
<div class="line"> gauge2 = <span class="keyword">new</span> CGauge ();</div>
<div class="line"> gauge2-&gt;SetFOwner (&amp;Window1);</div>
<div class="line"> gauge2-&gt;SetName (lxT (<span class="stringliteral">&quot;gauge2_px&quot;</span>));</div>
<div class="line"> gauge2-&gt;SetX (12);</div>
<div class="line"> gauge2-&gt;SetY (330 - 160);</div>
<div class="line"> gauge2-&gt;SetWidth (140);</div>
<div class="line"> gauge2-&gt;SetHeight (20);</div>
<div class="line"> gauge2-&gt;SetEnable (1);</div>
<div class="line"> gauge2-&gt;SetVisible (1);</div>
<div class="line"> gauge2-&gt;SetRange (100);</div>
<div class="line"> gauge2-&gt;SetValue (0);</div>
<div class="line"> gauge2-&gt;SetType (4);</div>
<div class="line"> Window1.CreateChild (gauge2);</div>
<div class="line"> <span class="comment">//label2</span></div>
<div class="line"> label2 = <span class="keyword">new</span> CLabel ();</div>
<div class="line"> label2-&gt;SetFOwner (&amp;Window1);</div>
<div class="line"> label2-&gt;SetName (lxT (<span class="stringliteral">&quot;label2_px&quot;</span>));</div>
<div class="line"> label2-&gt;SetX (12);</div>
<div class="line"> label2-&gt;SetY (306 - 160);</div>
<div class="line"> label2-&gt;SetWidth (60);</div>
<div class="line"> label2-&gt;SetHeight (20);</div>
<div class="line"> label2-&gt;SetEnable (1);</div>
<div class="line"> label2-&gt;SetVisible (1);</div>
<div class="line"> label2-&gt;SetText (lxT (<span class="stringliteral">&quot;RB0&quot;</span>));</div>
<div class="line"> label2-&gt;SetAlign (1);</div>
<div class="line"> Window1.CreateChild (label2);</div>
<div class="line"> <span class="comment">//label3</span></div>
<div class="line"> label3 = <span class="keyword">new</span> CLabel ();</div>
<div class="line"> label3-&gt;SetFOwner (&amp;Window1);</div>
<div class="line"> label3-&gt;SetName (lxT (<span class="stringliteral">&quot;label3_px&quot;</span>));</div>
<div class="line"> label3-&gt;SetX (13);</div>
<div class="line"> label3-&gt;SetY (357 - 160);</div>
<div class="line"> label3-&gt;SetWidth (60);</div>
<div class="line"> label3-&gt;SetHeight (20);</div>
<div class="line"> label3-&gt;SetEnable (1);</div>
<div class="line"> label3-&gt;SetVisible (1);</div>
<div class="line"> label3-&gt;SetText (lxT (<span class="stringliteral">&quot;RB1&quot;</span>));</div>
<div class="line"> label3-&gt;SetAlign (1);</div>
<div class="line"> Window1.CreateChild (label3);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Destructor called once on board destruction </span></div>
<div class="line"> </div>
<div class="line">cboard_x::~cboard_x(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">//controls destruction </span></div>
<div class="line"> Window1.DestroyChild (gauge1);</div>
<div class="line"> Window1.DestroyChild (gauge2);</div>
<div class="line"> Window1.DestroyChild (label2);</div>
<div class="line"> Window1.DestroyChild (label3);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Reset board status</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a6f87b4f00b9297a5893a805820c4a436">cboard_x::Reset</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> pic_reset (1);</div>
<div class="line"> </div>
<div class="line"> p_BT1 = 1; <span class="comment">//set push button  in default state (high) </span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//write button state to pic pin 19 (RD0)</span></div>
<div class="line"> pic_set_pin (19, p_BT1);</div>
<div class="line"> <span class="comment">//write switch state to pic pin 20 (RD1)</span></div>
<div class="line"> pic_set_pin (20, p_BT2);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//verify serial port state and refresh status bar  </span></div>
<div class="line"><span class="preprocessor">#ifndef _WIN_</span></div>
<div class="line"> <span class="keywordflow">if</span> (pic.serial[0].serialfd &gt; 0)</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> <span class="keywordflow">if</span> (pic.serial[0].serialfd != INVALID_HANDLE_VALUE)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  Window1.statusbar1.SetField (2, lxT (<span class="stringliteral">&quot;Serial: &quot;</span>) +</div>
<div class="line">                               lxString::FromAscii (SERIALDEVICE) + lxT (<span class="stringliteral">&quot;:&quot;</span>) + itoa (pic.serial[0].serialbaud) + lxT (<span class="stringliteral">&quot;(&quot;</span>) +</div>
<div class="line">                               lxString ().Format (<span class="stringliteral">&quot;%4.1f&quot;</span>, fabs ((100.0 * pic.serial[0].serialexbaud - 100.0 *</div>
<div class="line">                                                                   pic.serial[0].serialbaud) / pic.serial[0].serialexbaud)) + lxT (<span class="stringliteral">&quot;%)&quot;</span>));</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">  Window1.statusbar1.SetField (2, lxT (<span class="stringliteral">&quot;Serial: &quot;</span>) +</div>
<div class="line">                               lxString::FromAscii (SERIALDEVICE) + lxT (<span class="stringliteral">&quot; (ERROR)&quot;</span>));</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#ac41e7f65ae979416dd133853774e206e">use_spare</a>)Window5.<a class="code" href="class_c_p_window5.html#a371988205dfdb7dbb05150751c505f4a">Reset</a> ();</div>
<div class="line"> </div>
<div class="line"> <a class="code" href="classcboard__x.html#a9c1664ce551c79209b4e6dc9d0ed8730">RegisterRemoteControl</a> ();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Register variables to be controled by remote control</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a9c1664ce551c79209b4e6dc9d0ed8730">cboard_x::RegisterRemoteControl</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">//register inputa</span></div>
<div class="line"> <a class="code" href="classboard.html#a310d04440c58dd0d664c62a891518a9c">input_ids</a>[I_BD0]-&gt;<a class="code" href="structinput__t.html#aa46e9709c149cb3cdc28825ba28fb7ed">status</a> = &amp;p_BT1;</div>
<div class="line"> <a class="code" href="classboard.html#a310d04440c58dd0d664c62a891518a9c">input_ids</a>[I_SD1]-&gt;<a class="code" href="structinput__t.html#aa46e9709c149cb3cdc28825ba28fb7ed">status</a> = &amp;p_BT2;</div>
<div class="line"> <a class="code" href="classboard.html#a310d04440c58dd0d664c62a891518a9c">input_ids</a>[I_POT1]-&gt;<a class="code" href="structinput__t.html#aa46e9709c149cb3cdc28825ba28fb7ed">status</a> = &amp;pot1;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//register output to be updated on input change</span></div>
<div class="line"> <a class="code" href="classboard.html#a310d04440c58dd0d664c62a891518a9c">input_ids</a>[I_BD0]-&gt;<a class="code" href="structinput__t.html#a7a312dba32cd784ba2673747b24cd24c">update</a> = &amp;<a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_BD0]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a>;</div>
<div class="line"> <a class="code" href="classboard.html#a310d04440c58dd0d664c62a891518a9c">input_ids</a>[I_SD1]-&gt;<a class="code" href="structinput__t.html#a7a312dba32cd784ba2673747b24cd24c">update</a> = &amp;<a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_SD1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a>;</div>
<div class="line"> <a class="code" href="classboard.html#a310d04440c58dd0d664c62a891518a9c">input_ids</a>[I_POT1]-&gt;<a class="code" href="structinput__t.html#a7a312dba32cd784ba2673747b24cd24c">update</a> = &amp;<a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_POT1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//register outputa</span></div>
<div class="line"> <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB0]-&gt;<a class="code" href="structoutput__t.html#a394c193a9f75a821997918c3fe8525a5">status</a> = &amp;pic.pins[32].oavalue;</div>
<div class="line"> <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB1]-&gt;<a class="code" href="structoutput__t.html#a394c193a9f75a821997918c3fe8525a5">status</a> = &amp;pic.pins[33].oavalue;</div>
<div class="line"> <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD0]-&gt;<a class="code" href="structoutput__t.html#a394c193a9f75a821997918c3fe8525a5">status</a> = &amp;pic.pins[18].oavalue;</div>
<div class="line"> <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD1]-&gt;<a class="code" href="structoutput__t.html#a394c193a9f75a821997918c3fe8525a5">status</a> = &amp;pic.pins[19].oavalue;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Called ever 1s to refresh status</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a1492d042e89665dba3924b193f5bf9cc">cboard_x::RefreshStatus</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">//verify serial port state and refresh status bar   </span></div>
<div class="line"><span class="preprocessor">#ifndef _WIN_</span></div>
<div class="line"> <span class="keywordflow">if</span> (pic.serial[0].serialfd &gt; 0)</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> <span class="keywordflow">if</span> (pic.serial[0].serialfd != INVALID_HANDLE_VALUE)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  Window1.statusbar1.SetField (2, lxT (<span class="stringliteral">&quot;Serial: &quot;</span>) +</div>
<div class="line">                               lxString::FromAscii (SERIALDEVICE) + lxT (<span class="stringliteral">&quot;:&quot;</span>) + itoa (pic.serial[0].serialbaud) + lxT (<span class="stringliteral">&quot;(&quot;</span>) +</div>
<div class="line">                               lxString ().Format (<span class="stringliteral">&quot;%4.1f&quot;</span>, fabs ((100.0 * pic.serial[0].serialexbaud - 100.0 *</div>
<div class="line">                                                                   pic.serial[0].serialbaud) / pic.serial[0].serialexbaud)) + lxT (<span class="stringliteral">&quot;%)&quot;</span>));</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">  Window1.statusbar1.SetField (2, lxT (<span class="stringliteral">&quot;Serial: &quot;</span>) +</div>
<div class="line">                               lxString::FromAscii (SERIALDEVICE) + lxT (<span class="stringliteral">&quot; (ERROR)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Called to save board preferences in configuration file</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a5603baefc099825eeb53634ece32b2f8">cboard_x::WritePreferences</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">//write selected microcontroller of board_x to preferences</span></div>
<div class="line"> Window1.<a class="code" href="class_c_p_window1.html#abc98e682c927fc3071eb6da0880b795d">saveprefs</a> (lxT (<span class="stringliteral">&quot;X_proc&quot;</span>), <a class="code" href="classboard.html#a92f1e7588769e3cbc7cc0667c1bf3b8c">Proc</a>);</div>
<div class="line"> <span class="comment">//write switch state of board_x to preferences </span></div>
<div class="line"> Window1.<a class="code" href="class_c_p_window1.html#abc98e682c927fc3071eb6da0880b795d">saveprefs</a> (lxT (<span class="stringliteral">&quot;X_bt2&quot;</span>), lxString ().Format (<span class="stringliteral">&quot;%i&quot;</span>, p_BT2));</div>
<div class="line"> <span class="comment">//write microcontroller clock to preferences</span></div>
<div class="line"> Window1.<a class="code" href="class_c_p_window1.html#abc98e682c927fc3071eb6da0880b795d">saveprefs</a> (lxT (<span class="stringliteral">&quot;X_clock&quot;</span>), lxString ().Format (<span class="stringliteral">&quot;%2.1f&quot;</span>, Window1.GetClock ()));</div>
<div class="line"> <span class="comment">//write potentiometer position to preferences</span></div>
<div class="line"> Window1.<a class="code" href="class_c_p_window1.html#abc98e682c927fc3071eb6da0880b795d">saveprefs</a> (lxT (<span class="stringliteral">&quot;X_pot1&quot;</span>), lxString ().Format (<span class="stringliteral">&quot;%i&quot;</span>, pot1));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Called whe configuration file load  preferences </span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a696180daddb7dfc9b5bf5ad45fca0124">cboard_x::ReadPreferences</a>(<span class="keywordtype">char</span> *name, <span class="keywordtype">char</span> *value)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">//read switch state of board_x of preferences </span></div>
<div class="line"> <span class="keywordflow">if</span> (!strcmp (name, <span class="stringliteral">&quot;X_bt2&quot;</span>))</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">if</span> (value[0] == <span class="charliteral">&#39;0&#39;</span>)</div>
<div class="line">    p_BT2 = 0;</div>
<div class="line">   <span class="keywordflow">else</span></div>
<div class="line">    p_BT2 = 1;</div>
<div class="line">  }</div>
<div class="line"> <span class="comment">//read microcontroller of preferences</span></div>
<div class="line"> <span class="keywordflow">if</span> (!strcmp (name, <span class="stringliteral">&quot;X_proc&quot;</span>))</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classboard.html#a92f1e7588769e3cbc7cc0667c1bf3b8c">Proc</a> = value;</div>
<div class="line">  }</div>
<div class="line"> <span class="comment">//read microcontroller clock</span></div>
<div class="line"> <span class="keywordflow">if</span> (!strcmp (name, <span class="stringliteral">&quot;X_clock&quot;</span>))</div>
<div class="line">  {</div>
<div class="line">   Window1.SetClock (atof (value));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//read potentiometer position</span></div>
<div class="line"> <span class="keywordflow">if</span> (!strcmp (name, <span class="stringliteral">&quot;X_pot1&quot;</span>))</div>
<div class="line">  {</div>
<div class="line">   pot1 = atoi (value);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//Event on the board</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a3db74c02199e114e22f7a7a5b4e3dd96">cboard_x::EvKeyPress</a>(uint key, uint mask)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">//if keyboard key 1 is pressed then activate button (state=0)   </span></div>
<div class="line"> <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;1&#39;</span>)</div>
<div class="line">  {</div>
<div class="line">   p_BT1 = 0;</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_BD0]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//if keyboard key 2 is pressed then toggle switch state   </span></div>
<div class="line"> <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;2&#39;</span>)</div>
<div class="line">  {</div>
<div class="line">   p_BT2 ^= 1;</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_SD1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Event on the board</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#aef95af41c7e6c527dfe9e522912a19a2">cboard_x::EvKeyRelease</a>(uint key, uint mask)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">//if keyboard key 1 is pressed then deactivate button (state=1)     </span></div>
<div class="line"> <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;1&#39;</span>)</div>
<div class="line">  {</div>
<div class="line">   p_BT1 = 1;</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_BD0]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Event on the board</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a54f0b84ecd3973bdd3f7d8b7d13cc0b9">cboard_x::EvMouseButtonPress</a>(uint button, uint x, uint y, uint state)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//search for the input area which owner the event    </span></div>
<div class="line"> <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classboard.html#ad9f8dc51eeea817a22d9ffec01c1f0c2">inputc</a>; i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">if</span> (((<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].x1 &lt;= x)&amp;&amp;(<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].x2 &gt;= x))&amp;&amp;((<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].y1 &lt;= y)&amp;&amp;</div>
<div class="line">                                                  (<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].y2 &gt;= y)))</div>
<div class="line">    {</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">switch</span> (<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].<span class="keywordtype">id</span>)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">//if event is over I_ISCP area then load hex file  </span></div>
<div class="line">      <span class="keywordflow">case</span> I_ICSP:</div>
<div class="line">       Window1.menu1_File_LoadHex_EvMenuActive (NULL);</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">       <span class="comment">//if event is over I_PWR area then toggle board on/off</span></div>
<div class="line">      <span class="keywordflow">case</span> I_PWR:</div>
<div class="line">       <span class="keywordflow">if</span> (Window1.<a class="code" href="class_c_p_window1.html#af08244612c785b8acc158fbc5d95a444">Get_mcupwr</a> ()) <span class="comment">//if on turn off</span></div>
<div class="line">        {</div>
<div class="line">         Window1.<a class="code" href="class_c_p_window1.html#a8b2e0baf9fd9364d618f55dc943dc06c">Set_mcupwr</a> (0);</div>
<div class="line">         <a class="code" href="classcboard__x.html#a6f87b4f00b9297a5893a805820c4a436">Reset</a> ();</div>
<div class="line">         p_BT1 = 1;</div>
<div class="line">        }</div>
<div class="line">       <span class="keywordflow">else</span> <span class="comment">//if off turn on</span></div>
<div class="line">        {</div>
<div class="line">         Window1.<a class="code" href="class_c_p_window1.html#a8b2e0baf9fd9364d618f55dc943dc06c">Set_mcupwr</a> (1);</div>
<div class="line">         <a class="code" href="classcboard__x.html#a6f87b4f00b9297a5893a805820c4a436">Reset</a> ();</div>
<div class="line">        }</div>
<div class="line">       <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LPWR]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">       <span class="comment">//if event is over I_RST area then turn off and reset</span></div>
<div class="line">      <span class="keywordflow">case</span> I_RST:</div>
<div class="line">       <span class="keywordflow">if</span> (Window1.<a class="code" href="class_c_p_window1.html#af08244612c785b8acc158fbc5d95a444">Get_mcupwr</a> () &amp;&amp; pic_reset (-1))<span class="comment">//if powered</span></div>
<div class="line">        {</div>
<div class="line">         Window1.<a class="code" href="class_c_p_window1.html#a8b2e0baf9fd9364d618f55dc943dc06c">Set_mcupwr</a> (0);</div>
<div class="line">         Window1.Set_mcurst (1);</div>
<div class="line">        }</div>
<div class="line">       <a class="code" href="classboard.html#a7a851447b6b05b5f600cb587aae0c778">p_RST</a> = 0;</div>
<div class="line">       <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RST]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">       <span class="comment">//if event is over I_D0 area then activate button (state=0) </span></div>
<div class="line">      <span class="keywordflow">case</span> I_BD0:</div>
<div class="line">       p_BT1 = 0;</div>
<div class="line">       <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_BD0]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">       <span class="comment">//if event is over I_D1 area then toggle switch state   </span></div>
<div class="line">      <span class="keywordflow">case</span> I_SD1:</div>
<div class="line">       p_BT2 ^= 1;</div>
<div class="line">       <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_SD1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> I_POT1:</div>
<div class="line">       {</div>
<div class="line">        active = 1;</div>
<div class="line">        pot1 = (x - <a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].<a class="code" href="structinput__t.html#a1e2b92740c7fb766fb0e6a672b9bb498">x1</a>)*2.77;</div>
<div class="line">        <span class="keywordflow">if</span> (pot1 &gt; 199)pot1 = 199;</div>
<div class="line">        <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_POT1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       }</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Event on the board</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#acfd3a83c6a0ece11eb8d88dd9fa102f9">cboard_x::EvMouseMove</a>(uint button, uint x, uint y, uint state)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classboard.html#ad9f8dc51eeea817a22d9ffec01c1f0c2">inputc</a>; i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">switch</span> (<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].<span class="keywordtype">id</span>)</div>
<div class="line">    {</div>
<div class="line">    <span class="keywordflow">case</span> I_POT1:</div>
<div class="line">     <span class="keywordflow">if</span> (((<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].x1 &lt;= x)&amp;&amp;(<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].x2 &gt;= x))&amp;&amp;((<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].y1 &lt;= y)&amp;&amp;(<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].y2 &gt;= y)))</div>
<div class="line">      {</div>
<div class="line">       <span class="keywordflow">if</span> (active)</div>
<div class="line">        {</div>
<div class="line">         pot1 = (x - <a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].<a class="code" href="structinput__t.html#a1e2b92740c7fb766fb0e6a672b9bb498">x1</a>)*2.77;</div>
<div class="line">         <span class="keywordflow">if</span> (pot1 &gt; 199)pot1 = 199;</div>
<div class="line">         <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_POT1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">     <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">       active = 0;</div>
<div class="line">      }</div>
<div class="line">     <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Event on the board</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#abb94877b3a91eb371b3b20e2e9cebcce">cboard_x::EvMouseButtonRelease</a>(uint button, uint x, uint y, uint state)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//search for the input area which owner the event  </span></div>
<div class="line"> <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classboard.html#ad9f8dc51eeea817a22d9ffec01c1f0c2">inputc</a>; i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">if</span> (((<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].x1 &lt;= x)&amp;&amp;(<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].x2 &gt;= x))&amp;&amp;((<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].y1 &lt;= y)&amp;&amp;</div>
<div class="line">                                                  (<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].y2 &gt;= y)))</div>
<div class="line">    {</div>
<div class="line">     <span class="keywordflow">switch</span> (<a class="code" href="classboard.html#a637392ea82a18ee9f9716147455031dd">input</a>[i].<span class="keywordtype">id</span>)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">//if event is over I_RST area then turn on  </span></div>
<div class="line">      <span class="keywordflow">case</span> I_RST:</div>
<div class="line">       <span class="keywordflow">if</span> (Window1.<a class="code" href="class_c_p_window1.html#add73d25c4889d4e01489e335b509edb7">Get_mcurst</a> ())<span class="comment">//if powered</span></div>
<div class="line">        {</div>
<div class="line">         Window1.<a class="code" href="class_c_p_window1.html#a8b2e0baf9fd9364d618f55dc943dc06c">Set_mcupwr</a> (1);</div>
<div class="line">         Window1.Set_mcurst (0);</div>
<div class="line"> </div>
<div class="line">         <span class="keywordflow">if</span> (pic_reset (-1))</div>
<div class="line">          {</div>
<div class="line">           <a class="code" href="classcboard__x.html#a6f87b4f00b9297a5893a805820c4a436">Reset</a> ();</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">       <a class="code" href="classboard.html#a7a851447b6b05b5f600cb587aae0c778">p_RST</a> = 1;</div>
<div class="line">       <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RST]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">       <span class="comment">//if event is over I_D0 area then deactivate button (state=1) </span></div>
<div class="line">      <span class="keywordflow">case</span> I_BD0:</div>
<div class="line">       p_BT1 = 1;</div>
<div class="line">       <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_BD0]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> I_POT1:</div>
<div class="line">       {</div>
<div class="line">        active = 0;</div>
<div class="line">        <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_POT1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">       }</div>
<div class="line">       <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//Called ever 100ms to draw board</span></div>
<div class="line"><span class="comment">//This is the critical code for simulator running speed</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a18ebbd336dc27b64c0fdcc6a5d580ee4">cboard_x::Draw</a>(CDraw *draw)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">int</span> update = 0; <span class="comment">//verifiy if updated is needed</span></div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//board_x draw </span></div>
<div class="line"> <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classboard.html#a52d4e88ddf5f29d1648ea94dafbf87de">outputc</a>; i++) <span class="comment">//run over all outputs</span></div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">if</span> (<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].update)<span class="comment">//only if need update</span></div>
<div class="line">    {</div>
<div class="line">     <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 0;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (!update)</div>
<div class="line">      {</div>
<div class="line">       draw-&gt;Canvas.Init (Scale, Scale);</div>
<div class="line">      }</div>
<div class="line">     update++; <span class="comment">//set to update buffer</span></div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (!<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].r)<span class="comment">//if output shape is a rectangle</span></div>
<div class="line">      {</div>
<div class="line">       <span class="keywordflow">if</span> (<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<span class="keywordtype">id</span> == O_SD1)<span class="comment">//if output is switch</span></div>
<div class="line">        {</div>
<div class="line">         <span class="comment">//draw a background white rectangle   </span></div>
<div class="line">         draw-&gt;Canvas.SetBgColor (255, 255, 255);</div>
<div class="line">         draw-&gt;Canvas.Rectangle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1,</div>
<div class="line">                                 <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1);</div>
<div class="line"> </div>
<div class="line">         <span class="keywordflow">if</span> (!p_BT2) <span class="comment">//draw switch off</span></div>
<div class="line">          {</div>
<div class="line">           <span class="comment">//draw a grey rectangle  </span></div>
<div class="line">           draw-&gt;Canvas.SetBgColor (70, 70, 70);</div>
<div class="line">           draw-&gt;Canvas.Rectangle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1 +</div>
<div class="line">                                   ((<span class="keywordtype">int</span>) ((<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1)*0.35)), <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1,</div>
<div class="line">                                   (<span class="keywordtype">int</span>) ((<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1)*0.65));</div>
<div class="line">          }</div>
<div class="line">         <span class="keywordflow">else</span> <span class="comment">//draw switch on</span></div>
<div class="line">          {</div>
<div class="line">           <span class="comment">//draw a grey rectangle  </span></div>
<div class="line">           draw-&gt;Canvas.SetBgColor (70, 70, 70);</div>
<div class="line">           draw-&gt;Canvas.Rectangle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1,</div>
<div class="line">                                   <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1,</div>
<div class="line">                                   (<span class="keywordtype">int</span>) ((<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1)*0.65));</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<span class="keywordtype">id</span> == O_BD0)</div>
<div class="line">        {</div>
<div class="line">         draw-&gt;Canvas.SetColor (102, 102, 102);</div>
<div class="line">         draw-&gt;Canvas.Circle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cx, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cy, 10);</div>
<div class="line">         <span class="keywordflow">if</span> (p_BT1)</div>
<div class="line">          {</div>
<div class="line">           draw-&gt;Canvas.SetColor (15, 15, 15);</div>
<div class="line">          }</div>
<div class="line">         <span class="keywordflow">else</span></div>
<div class="line">          {</div>
<div class="line">           draw-&gt;Canvas.SetColor (55, 55, 55);</div>
<div class="line">          }</div>
<div class="line">         draw-&gt;Canvas.Circle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cx, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cy, 8);</div>
<div class="line">        }</div>
<div class="line">       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<span class="keywordtype">id</span> == O_RST)</div>
<div class="line">        {</div>
<div class="line">         draw-&gt;Canvas.SetColor (102, 102, 102);</div>
<div class="line">         draw-&gt;Canvas.Circle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cx, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cy, 10);</div>
<div class="line"> </div>
<div class="line">         <span class="keywordflow">if</span> (<a class="code" href="classboard.html#a7a851447b6b05b5f600cb587aae0c778">p_RST</a>)</div>
<div class="line">          {</div>
<div class="line">           draw-&gt;Canvas.SetColor (15, 15, 15);</div>
<div class="line">          }</div>
<div class="line">         <span class="keywordflow">else</span></div>
<div class="line">          {</div>
<div class="line">           draw-&gt;Canvas.SetColor (55, 55, 55);</div>
<div class="line">          }</div>
<div class="line">         draw-&gt;Canvas.Circle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cx, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].cy, 8);</div>
<div class="line">        }</div>
<div class="line">       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<span class="keywordtype">id</span> == O_POT1)</div>
<div class="line">        {</div>
<div class="line">         draw-&gt;Canvas.SetColor (0, 50, 215);</div>
<div class="line">         draw-&gt;Canvas.Rectangle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1);</div>
<div class="line">         draw-&gt;Canvas.SetColor (250, 250, 250);</div>
<div class="line">         draw-&gt;Canvas.Rectangle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1 + pot1 / 2.77, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1 + 2, 10, 15);</div>
<div class="line">        }</div>
<div class="line">       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<span class="keywordtype">id</span> == O_CPU)</div>
<div class="line">        {</div>
<div class="line">         draw-&gt;Canvas.SetFont (font);</div>
<div class="line">         <span class="keywordtype">int</span> x, y, w, h;</div>
<div class="line">         draw-&gt;Canvas.SetColor (26, 26, 26);</div>
<div class="line">         draw-&gt;Canvas.Rectangle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y2 - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1);</div>
<div class="line"> </div>
<div class="line">         draw-&gt;Canvas.SetColor (230, 230, 230);</div>
<div class="line">         w = <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<a class="code" href="structoutput__t.html#a62355ce1deb5d7a3a7955b5bb25ac26c">x2</a> - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<a class="code" href="structoutput__t.html#a4a26c232a33f2387180a8bc0b6c078e7">x1</a>;</div>
<div class="line">         h = <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<a class="code" href="structoutput__t.html#aabca51d7095f7ba0b654cbcfea9cd6b7">y2</a> - <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<a class="code" href="structoutput__t.html#aabca51d7095f7ba0b654cbcfea9cd6b7">y2</a>;</div>
<div class="line">         x = <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<a class="code" href="structoutput__t.html#a4a26c232a33f2387180a8bc0b6c078e7">x1</a> + (w / 2) + 7;</div>
<div class="line">         y = <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<a class="code" href="structoutput__t.html#a3ea90d25dafd4e3f279f3f541a956ffa">y1</a> + (h / 2) + (<a class="code" href="classboard.html#a92f1e7588769e3cbc7cc0667c1bf3b8c">Proc</a>.length ());</div>
<div class="line">         draw-&gt;Canvas.RotatedText (<a class="code" href="classboard.html#a92f1e7588769e3cbc7cc0667c1bf3b8c">Proc</a>, x, y, 270);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">     <span class="keywordflow">else</span> <span class="comment">//if output shape is a circle</span></div>
<div class="line">      {</div>
<div class="line">       draw-&gt;Canvas.SetFgColor (0, 0, 0); <span class="comment">//black</span></div>
<div class="line"> </div>
<div class="line">       <span class="keywordflow">switch</span> (<a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].<span class="keywordtype">id</span>)<span class="comment">//search for color of output</span></div>
<div class="line">        {</div>
<div class="line">        <span class="keywordflow">case</span> O_LD0: <span class="comment">//White using pin 19 mean value (RD0)</span></div>
<div class="line">         draw-&gt;Canvas.SetBgColor (pic.pins[18].oavalue, pic.pins[18].oavalue, pic.pins[18].oavalue);</div>
<div class="line">         <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> O_LD1: <span class="comment">//Yelllow using pin 20 mean value (RD1)</span></div>
<div class="line">         draw-&gt;Canvas.SetBgColor (pic.pins[19].oavalue, pic.pins[19].oavalue, 0);</div>
<div class="line">         <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> O_LPWR: <span class="comment">//Blue using mcupwr value</span></div>
<div class="line">         draw-&gt;Canvas.SetBgColor (0, 0, 200 * Window1.<a class="code" href="class_c_p_window1.html#af08244612c785b8acc158fbc5d95a444">Get_mcupwr</a> () + 55);</div>
<div class="line">         <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> O_RB0: <span class="comment">//Green using pin 33 mean value (RB0)</span></div>
<div class="line">         draw-&gt;Canvas.SetBgColor (0, pic.pins[32].oavalue, 0);</div>
<div class="line">         <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> O_RB1: <span class="comment">//Red using pin 34 mean value (RB1)</span></div>
<div class="line">         draw-&gt;Canvas.SetBgColor (pic.pins[33].oavalue, 0, 0);</div>
<div class="line">         <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">       <span class="comment">//draw a LED</span></div>
<div class="line">       color1 = draw-&gt;Canvas.GetBgColor ();</div>
<div class="line">       <span class="keywordtype">int</span> r = color1.Red () - 120;</div>
<div class="line">       <span class="keywordtype">int</span> g = color1.Green () - 120;</div>
<div class="line">       <span class="keywordtype">int</span> b = color1.Blue () - 120;</div>
<div class="line">       <span class="keywordflow">if</span> (r &lt; 0)r = 0;</div>
<div class="line">       <span class="keywordflow">if</span> (g &lt; 0)g = 0;</div>
<div class="line">       <span class="keywordflow">if</span> (b &lt; 0)b = 0;</div>
<div class="line">       color2.Set (r, g, b);</div>
<div class="line">       draw-&gt;Canvas.SetBgColor (color2);</div>
<div class="line">       draw-&gt;Canvas.Circle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].r + 1);</div>
<div class="line">       draw-&gt;Canvas.SetBgColor (color1);</div>
<div class="line">       draw-&gt;Canvas.Circle (1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].x1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].y1, <a class="code" href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">output</a>[i].r - 2);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> <span class="comment">//end draw</span></div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (update)</div>
<div class="line">  {</div>
<div class="line">   draw-&gt;Canvas.End ();</div>
<div class="line">   draw-&gt;Update ();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//RB0 mean value to gauge1</span></div>
<div class="line"> gauge1-&gt;SetValue ((pic.pins[33].oavalue - 55) / 2);</div>
<div class="line"> <span class="comment">//RB1 mean value to gauge2</span></div>
<div class="line"> gauge2-&gt;SetValue ((pic.pins[32].oavalue - 55) / 2);</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="classcboard__x.html#a6337aae979579d9d180026dfcd2c55c0">cboard_x::Run_CPU</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> <span class="keywordtype">int</span> j;</div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pi;</div>
<div class="line"> <span class="keyword">const</span> picpin * pins;</div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> alm[40];</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">int</span> JUMPSTEPS = Window1.<a class="code" href="class_c_p_window1.html#a003a0f87f554fef0aff246adc7b3c82d">GetJUMPSTEPS</a> (); <span class="comment">//number of steps skipped</span></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> NSTEP = Window1.GetNSTEP (); <span class="comment">//number of steps in 100ms</span></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span> RNSTEP = 200.0 * pic.PINCOUNT / NSTEP;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//reset pins mean value</span></div>
<div class="line"> memset (alm, 0, 40 * <span class="keyword">sizeof</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//read pic.pins to a local variable to speed up </span></div>
<div class="line"> pins = pic.pins;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Spare parts window pre process</span></div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#ac41e7f65ae979416dd133853774e206e">use_spare</a>)Window5.<a class="code" href="class_c_p_window5.html#a02d69b9e32726649eaa1c325e2b7af70">PreProcess</a> ();</div>
<div class="line"> </div>
<div class="line"> j = JUMPSTEPS; <span class="comment">//step counter</span></div>
<div class="line"> pi = 0;</div>
<div class="line"> <span class="keywordflow">if</span> (Window1.<a class="code" href="class_c_p_window1.html#af08244612c785b8acc158fbc5d95a444">Get_mcupwr</a> ()) <span class="comment">//if powered</span></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; NSTEP; i++) <span class="comment">//repeat for number of steps in 100ms</span></div>
<div class="line">   {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (j &gt;= JUMPSTEPS)<span class="comment">//if number of step is bigger than steps to skip </span></div>
<div class="line">     {</div>
<div class="line">      pic_set_pin (pic.mclr, <a class="code" href="classboard.html#a7a851447b6b05b5f600cb587aae0c778">p_RST</a>);</div>
<div class="line">      pic_set_pin (19, p_BT1); <span class="comment">//Set pin 19 (RD0) with button state </span></div>
<div class="line">      pic_set_pin (20, p_BT2); <span class="comment">//Set pin 20 (RD1) with switch state </span></div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//verify if a breakpoint is reached if not run one instruction </span></div>
<div class="line">    <span class="keywordflow">if</span> (!mplabxd_testbp ())pic_step ();</div>
<div class="line">    ioupdated = pic.ioupdated;</div>
<div class="line">    <span class="comment">//Oscilloscope window process</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="classboard.html#a1f5dedbf50d1ebd86af96429a4a3d180">use_oscope</a>)Window4.<a class="code" href="class_c_p_window4.html#a3193dfdbbbd823e021fc60bdc402bfc2">SetSample</a> ();</div>
<div class="line">    <span class="comment">//Spare parts window process</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="classboard.html#ac41e7f65ae979416dd133853774e206e">use_spare</a>)Window5.<a class="code" href="class_c_p_window5.html#abf4a593790774e9c184e4876ed7fd1b3">Process</a> ();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//increment mean value counter if pin is high</span></div>
<div class="line">    alm[pi] += pins[pi].value;</div>
<div class="line">    pi++;</div>
<div class="line">    <span class="keywordflow">if</span> (pi == pic.PINCOUNT)pi = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (j &gt;= JUMPSTEPS)<span class="comment">//if number of step is bigger than steps to skip </span></div>
<div class="line">     {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">//set analog pin 2 (AN0) with value from scroll  </span></div>
<div class="line">      pic_set_apin (2, (5.0 * pot1 / 199));</div>
<div class="line"> </div>
<div class="line">      j = -1; <span class="comment">//reset counter</span></div>
<div class="line">     }</div>
<div class="line">    j++; <span class="comment">//counter increment</span></div>
<div class="line">    pic.ioupdated = 0;</div>
<div class="line">   }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//calculate mean value</span></div>
<div class="line"> <span class="keywordflow">for</span> (pi = 0; pi &lt; pic.PINCOUNT; pi++)</div>
<div class="line">  {</div>
<div class="line">   pic.pins[pi].oavalue = (int) ((alm[pi] * RNSTEP) + 55);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Spare parts window pre post process</span></div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#ac41e7f65ae979416dd133853774e206e">use_spare</a>)Window5.<a class="code" href="class_c_p_window5.html#a7b033d0c44a3dfc514d5506b74ad5abb">PostProcess</a> ();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//verifiy if LEDS need update </span></div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD0]-&gt;value != pic.pins[18].oavalue)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD0]-&gt;<a class="code" href="structoutput__t.html#a23bc69196fed4d0e4924453a11e182bd">value</a> = pic.pins[18].oavalue;</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD0]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD1]-&gt;value != pic.pins[19].oavalue)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD1]-&gt;<a class="code" href="structoutput__t.html#a23bc69196fed4d0e4924453a11e182bd">value</a> = pic.pins[19].oavalue;</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_LD1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB0]-&gt;value != pic.pins[32].oavalue)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB0]-&gt;<a class="code" href="structoutput__t.html#a23bc69196fed4d0e4924453a11e182bd">value</a> = pic.pins[32].oavalue;</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB0]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB1]-&gt;value != pic.pins[33].oavalue)</div>
<div class="line">  {</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB1]-&gt;<a class="code" href="structoutput__t.html#a23bc69196fed4d0e4924453a11e182bd">value</a> = pic.pins[33].oavalue;</div>
<div class="line">   <a class="code" href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">output_ids</a>[O_RB1]-&gt;<a class="code" href="structoutput__t.html#aa91b1205a6823abba2269f91bb87863d">update</a> = 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//Register the board in PICSimLab</span></div>
<div class="line">board_init(BOARD_x_Name, <a class="code" href="classcboard__x.html">cboard_x</a>);</div>
<div class="line"> </div>
<div class="ttc" id="aclass_c_p_window1_html_a003a0f87f554fef0aff246adc7b3c82d"><div class="ttname"><a href="class_c_p_window1.html#a003a0f87f554fef0aff246adc7b3c82d">CPWindow1::GetJUMPSTEPS</a></div><div class="ttdeci">int GetJUMPSTEPS(void)</div><div class="ttdoc">Get the number of steps to be skipped in board update.</div><div class="ttdef"><b>Definition:</b> picsimlab1.h:287</div></div>
<div class="ttc" id="aclass_c_p_window1_html_a8b2e0baf9fd9364d618f55dc943dc06c"><div class="ttname"><a href="class_c_p_window1.html#a8b2e0baf9fd9364d618f55dc943dc06c">CPWindow1::Set_mcupwr</a></div><div class="ttdeci">void Set_mcupwr(int pp)</div><div class="ttdoc">Set the power status of microcontroller ON/OFF.</div><div class="ttdef"><b>Definition:</b> picsimlab1.h:238</div></div>
<div class="ttc" id="aclass_c_p_window1_html_abc98e682c927fc3071eb6da0880b795d"><div class="ttname"><a href="class_c_p_window1.html#abc98e682c927fc3071eb6da0880b795d">CPWindow1::saveprefs</a></div><div class="ttdeci">void saveprefs(lxString name, lxString value)</div><div class="ttdoc">Save the preferences.</div><div class="ttdef"><b>Definition:</b> picsimlab1.cc:900</div></div>
<div class="ttc" id="aclass_c_p_window1_html_add73d25c4889d4e01489e335b509edb7"><div class="ttname"><a href="class_c_p_window1.html#add73d25c4889d4e01489e335b509edb7">CPWindow1::Get_mcurst</a></div><div class="ttdeci">int Get_mcurst(void)</div><div class="ttdoc">Retunr if microcontroller reset pin is enabled.</div><div class="ttdef"><b>Definition:</b> picsimlab1.h:227</div></div>
<div class="ttc" id="aclass_c_p_window1_html_af08244612c785b8acc158fbc5d95a444"><div class="ttname"><a href="class_c_p_window1.html#af08244612c785b8acc158fbc5d95a444">CPWindow1::Get_mcupwr</a></div><div class="ttdeci">int Get_mcupwr(void)</div><div class="ttdoc">Return actual power status of microcontroller ON/OFF.</div><div class="ttdef"><b>Definition:</b> picsimlab1.h:220</div></div>
<div class="ttc" id="aclass_c_p_window4_html_a3193dfdbbbd823e021fc60bdc402bfc2"><div class="ttname"><a href="class_c_p_window4.html#a3193dfdbbbd823e021fc60bdc402bfc2">CPWindow4::SetSample</a></div><div class="ttdeci">void SetSample(void)</div><div class="ttdoc">Sample and update oscilloscope data aquisition.</div><div class="ttdef"><b>Definition:</b> picsimlab4.cc:382</div></div>
<div class="ttc" id="aclass_c_p_window5_html_a02d69b9e32726649eaa1c325e2b7af70"><div class="ttname"><a href="class_c_p_window5.html#a02d69b9e32726649eaa1c325e2b7af70">CPWindow5::PreProcess</a></div><div class="ttdeci">void PreProcess(void)</div><div class="ttdoc">Execute the pre process code of spare parts one time per 100ms.</div><div class="ttdef"><b>Definition:</b> picsimlab5.cc:883</div></div>
<div class="ttc" id="aclass_c_p_window5_html_a371988205dfdb7dbb05150751c505f4a"><div class="ttname"><a href="class_c_p_window5.html#a371988205dfdb7dbb05150751c505f4a">CPWindow5::Reset</a></div><div class="ttdeci">void Reset(void)</div><div class="ttdoc">Reset all spare parts.</div><div class="ttdef"><b>Definition:</b> picsimlab5.cc:948</div></div>
<div class="ttc" id="aclass_c_p_window5_html_a7b033d0c44a3dfc514d5506b74ad5abb"><div class="ttname"><a href="class_c_p_window5.html#a7b033d0c44a3dfc514d5506b74ad5abb">CPWindow5::PostProcess</a></div><div class="ttdeci">void PostProcess(void)</div><div class="ttdoc">Execute the post process code of spare parts one time per 100ms.</div><div class="ttdef"><b>Definition:</b> picsimlab5.cc:939</div></div>
<div class="ttc" id="aclass_c_p_window5_html_abf4a593790774e9c184e4876ed7fd1b3"><div class="ttname"><a href="class_c_p_window5.html#abf4a593790774e9c184e4876ed7fd1b3">CPWindow5::Process</a></div><div class="ttdeci">void Process(void)</div><div class="ttdoc">Execute the process code of spare parts N times (where N is the number of steps in 100ms)</div><div class="ttdef"><b>Definition:</b> picsimlab5.cc:907</div></div>
<div class="ttc" id="aclassboard_html_a1f5dedbf50d1ebd86af96429a4a3d180"><div class="ttname"><a href="classboard.html#a1f5dedbf50d1ebd86af96429a4a3d180">board::use_oscope</a></div><div class="ttdeci">int use_oscope</div><div class="ttdoc">use oscilloscope window</div><div class="ttdef"><b>Definition:</b> board.h:516</div></div>
<div class="ttc" id="aclassboard_html_a310d04440c58dd0d664c62a891518a9c"><div class="ttname"><a href="classboard.html#a310d04440c58dd0d664c62a891518a9c">board::input_ids</a></div><div class="ttdeci">input_t * input_ids[120]</div><div class="ttdoc">input map elements by id order</div><div class="ttdef"><b>Definition:</b> board.h:511</div></div>
<div class="ttc" id="aclassboard_html_a52d4e88ddf5f29d1648ea94dafbf87de"><div class="ttname"><a href="classboard.html#a52d4e88ddf5f29d1648ea94dafbf87de">board::outputc</a></div><div class="ttdeci">int outputc</div><div class="ttdoc">output map elements counter</div><div class="ttdef"><b>Definition:</b> board.h:515</div></div>
<div class="ttc" id="aclassboard_html_a637392ea82a18ee9f9716147455031dd"><div class="ttname"><a href="classboard.html#a637392ea82a18ee9f9716147455031dd">board::input</a></div><div class="ttdeci">input_t input[120]</div><div class="ttdoc">input map elements</div><div class="ttdef"><b>Definition:</b> board.h:510</div></div>
<div class="ttc" id="aclassboard_html_a7a851447b6b05b5f600cb587aae0c778"><div class="ttname"><a href="classboard.html#a7a851447b6b05b5f600cb587aae0c778">board::p_RST</a></div><div class="ttdeci">unsigned char p_RST</div><div class="ttdoc">board /RESET pin state</div><div class="ttdef"><b>Definition:</b> board.h:518</div></div>
<div class="ttc" id="aclassboard_html_a92f1e7588769e3cbc7cc0667c1bf3b8c"><div class="ttname"><a href="classboard.html#a92f1e7588769e3cbc7cc0667c1bf3b8c">board::Proc</a></div><div class="ttdeci">lxString Proc</div><div class="ttdoc">Name of processor in use.</div><div class="ttdef"><b>Definition:</b> board.h:507</div></div>
<div class="ttc" id="aclassboard_html_a94afe9318a9cd0d8635d0043424a8682"><div class="ttname"><a href="classboard.html#a94afe9318a9cd0d8635d0043424a8682">board::output_ids</a></div><div class="ttdeci">output_t * output_ids[120]</div><div class="ttdoc">output map elements by id order</div><div class="ttdef"><b>Definition:</b> board.h:513</div></div>
<div class="ttc" id="aclassboard_html_abb9694f4430944f5f6e110c3af6feb3e"><div class="ttname"><a href="classboard.html#abb9694f4430944f5f6e110c3af6feb3e">board::output</a></div><div class="ttdeci">output_t output[120]</div><div class="ttdoc">output map elements</div><div class="ttdef"><b>Definition:</b> board.h:512</div></div>
<div class="ttc" id="aclassboard_html_ac41e7f65ae979416dd133853774e206e"><div class="ttname"><a href="classboard.html#ac41e7f65ae979416dd133853774e206e">board::use_spare</a></div><div class="ttdeci">int use_spare</div><div class="ttdoc">use spare parts window</div><div class="ttdef"><b>Definition:</b> board.h:517</div></div>
<div class="ttc" id="aclassboard_html_ad9f8dc51eeea817a22d9ffec01c1f0c2"><div class="ttname"><a href="classboard.html#ad9f8dc51eeea817a22d9ffec01c1f0c2">board::inputc</a></div><div class="ttdeci">int inputc</div><div class="ttdoc">input map elements counter</div><div class="ttdef"><b>Definition:</b> board.h:514</div></div>
<div class="ttc" id="astructinput__t_html_a1e2b92740c7fb766fb0e6a672b9bb498"><div class="ttname"><a href="structinput__t.html#a1e2b92740c7fb766fb0e6a672b9bb498">input_t::x1</a></div><div class="ttdeci">unsigned int x1</div><div class="ttdoc">x1 position</div><div class="ttdef"><b>Definition:</b> board.h:44</div></div>
<div class="ttc" id="astructinput__t_html_a7a312dba32cd784ba2673747b24cd24c"><div class="ttname"><a href="structinput__t.html#a7a312dba32cd784ba2673747b24cd24c">input_t::update</a></div><div class="ttdeci">unsigned char * update</div><div class="ttdoc">output need draw update</div><div class="ttdef"><b>Definition:</b> board.h:53</div></div>
<div class="ttc" id="astructinput__t_html_aa46e9709c149cb3cdc28825ba28fb7ed"><div class="ttname"><a href="structinput__t.html#aa46e9709c149cb3cdc28825ba28fb7ed">input_t::status</a></div><div class="ttdeci">void * status</div><div class="ttdoc">rcontrol status</div><div class="ttdef"><b>Definition:</b> board.h:52</div></div>
<div class="ttc" id="astructoutput__t_html_a23bc69196fed4d0e4924453a11e182bd"><div class="ttname"><a href="structoutput__t.html#a23bc69196fed4d0e4924453a11e182bd">output_t::value</a></div><div class="ttdeci">unsigned char value</div><div class="ttdoc">updated value</div><div class="ttdef"><b>Definition:</b> board.h:78</div></div>
<div class="ttc" id="astructoutput__t_html_a62355ce1deb5d7a3a7955b5bb25ac26c"><div class="ttname"><a href="structoutput__t.html#a62355ce1deb5d7a3a7955b5bb25ac26c">output_t::x2</a></div><div class="ttdeci">unsigned int x2</div><div class="ttdoc">x2 position</div><div class="ttdef"><b>Definition:</b> board.h:67</div></div>
<div class="ttc" id="astructoutput__t_html_aabca51d7095f7ba0b654cbcfea9cd6b7"><div class="ttname"><a href="structoutput__t.html#aabca51d7095f7ba0b654cbcfea9cd6b7">output_t::y2</a></div><div class="ttdeci">unsigned int y2</div><div class="ttdoc">y2 position</div><div class="ttdef"><b>Definition:</b> board.h:69</div></div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
